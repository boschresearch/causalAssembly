
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Documentation - causalAssembly Doku</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#causalAssembly.models_dag" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL(".."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="causalAssembly Doku" class="md-header__button md-logo" aria-label="causalAssembly Doku" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            causalAssembly Doku
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Documentation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="causalAssembly Doku" class="md-nav__button md-logo" aria-label="causalAssembly Doku" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    causalAssembly Doku
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag" class="md-nav__link">
    <span class="md-ellipsis">
      models_dag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.NodeAttributes" class="md-nav__link">
    <span class="md-ellipsis">
      NodeAttributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell" class="md-nav__link">
    <span class="md-ellipsis">
      ProcessCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProcessCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.module_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      module_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.no_of_modules" class="md-nav__link">
    <span class="md-ellipsis">
      no_of_modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__verify_edges_are_allowed" class="md-nav__link">
    <span class="md-ellipsis">
      __verify_edges_are_allowed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.add_module" class="md-nav__link">
    <span class="md-ellipsis">
      add_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.add_random_module" class="md-nav__link">
    <span class="md-ellipsis">
      add_random_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.connect_by_module" class="md-nav__link">
    <span class="md-ellipsis">
      connect_by_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.connect_by_random_edges" class="md-nav__link">
    <span class="md-ellipsis">
      connect_by_random_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.get_available_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.input_cellgraph_directly" class="md-nav__link">
    <span class="md-ellipsis">
      input_cellgraph_directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.next_module_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      next_module_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph" class="md-nav__link">
    <span class="md-ellipsis">
      ProductionLineGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProductionLineGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.between_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      between_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.eol_cell" class="md-nav__link">
    <span class="md-ellipsis">
      eol_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.ground_truth_visible" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth_visible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.interventions" class="md-nav__link">
    <span class="md-ellipsis">
      interventions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.within_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      within_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.connect_across_cells_manually" class="md-nav__link">
    <span class="md-ellipsis">
      connect_across_cells_manually
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.connect_cells" class="md-nav__link">
    <span class="md-ellipsis">
      connect_cells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.from_nx" class="md-nav__link">
    <span class="md-ellipsis">
      from_nx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      get_ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_nodes_of_station" class="md-nav__link">
    <span class="md-ellipsis">
      get_nodes_of_station
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.hidden_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      hidden_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.intervene_on" class="md-nav__link">
    <span class="md-ellipsis">
      intervene_on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.interventional_amat" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_amat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.load_drf" class="md-nav__link">
    <span class="md-ellipsis">
      load_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.load_pline_from_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      load_pline_from_pickle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.new_cell" class="md-nav__link">
    <span class="md-ellipsis">
      new_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sample_from_interventional_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_interventional_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.via_cell_number" class="md-nav__link">
    <span class="md-ellipsis">
      via_cell_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.visible_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      visible_nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.choose_edges_from_cells_randomly" class="md-nav__link">
    <span class="md-ellipsis">
      choose_edges_from_cells_randomly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.get_arrow_head_candidates_from_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_arrow_head_candidates_from_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils" class="md-nav__link">
    <span class="md-ellipsis">
      dag_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.merge_dags" class="md-nav__link">
    <span class="md-ellipsis">
      merge_dags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.merge_dags_via_edges" class="md-nav__link">
    <span class="md-ellipsis">
      merge_dags_via_edges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.tuples_from_cartesian_product" class="md-nav__link">
    <span class="md-ellipsis">
      tuples_from_cartesian_product
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm" class="md-nav__link">
    <span class="md-ellipsis">
      models_fcm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM" class="md-nav__link">
    <span class="md-ellipsis">
      FCM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FCM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventions" class="md-nav__link">
    <span class="md-ellipsis">
      interventions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.source_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      source_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__distribution_parameters_explicit" class="md-nav__link">
    <span class="md-ellipsis">
      __distribution_parameters_explicit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__eval_expression" class="md-nav__link">
    <span class="md-ellipsis">
      __eval_expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__source_df_condition" class="md-nav__link">
    <span class="md-ellipsis">
      __source_df_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.causal_order_of" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.display_functions" class="md-nav__link">
    <span class="md-ellipsis">
      display_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.function_of" class="md-nav__link">
    <span class="md-ellipsis">
      function_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.input_fcm" class="md-nav__link">
    <span class="md-ellipsis">
      input_fcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.intervene_on" class="md-nav__link">
    <span class="md-ellipsis">
      intervene_on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventional_amat" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_amat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventional_sample" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.parents_of" class="md-nav__link">
    <span class="md-ellipsis">
      parents_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.show_mutilated_dag" class="md-nav__link">
    <span class="md-ellipsis">
      show_mutilated_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.source_nodes_of" class="md-nav__link">
    <span class="md-ellipsis">
      source_nodes_of
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      DAGmetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAGmetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics.collect_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      collect_metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting" class="md-nav__link">
    <span class="md-ellipsis">
      drf_fitting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF" class="md-nav__link">
    <span class="md-ellipsis">
      DRF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DRF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.produce_sample" class="md-nav__link">
    <span class="md-ellipsis">
      produce_sample
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.fit_drf" class="md-nav__link">
    <span class="md-ellipsis">
      fit_drf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag" class="md-nav__link">
    <span class="md-ellipsis">
      pdag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG" class="md-nav__link">
    <span class="md-ellipsis">
      PDAG
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.adjacency_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      adjacency_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.dir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      dir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.nnodes" class="md-nav__link">
    <span class="md-ellipsis">
      nnodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_adjacencies" class="md-nav__link">
    <span class="md-ellipsis">
      num_adjacencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_dir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_dir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_undir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_undir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      undir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.children" class="md-nav__link">
    <span class="md-ellipsis">
      children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.from_pandas_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.is_adjacent" class="md-nav__link">
    <span class="md-ellipsis">
      is_adjacent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.is_clique" class="md-nav__link">
    <span class="md-ellipsis">
      is_clique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.remove_edge" class="md-nav__link">
    <span class="md-ellipsis">
      remove_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.remove_node" class="md-nav__link">
    <span class="md-ellipsis">
      remove_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_allDAGs" class="md-nav__link">
    <span class="md-ellipsis">
      to_allDAGs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_dag" class="md-nav__link">
    <span class="md-ellipsis">
      to_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_random_dag" class="md-nav__link">
    <span class="md-ellipsis">
      to_random_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      undir_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_to_dir_edge" class="md-nav__link">
    <span class="md-ellipsis">
      undir_to_dir_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.dag2cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      dag2cpdag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_1" class="md-nav__link">
    <span class="md-ellipsis">
      rule_1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_2" class="md-nav__link">
    <span class="md-ellipsis">
      rule_2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_3" class="md-nav__link">
    <span class="md-ellipsis">
      rule_3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_4" class="md-nav__link">
    <span class="md-ellipsis">
      rule_4
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag" class="md-nav__link">
    <span class="md-ellipsis">
      dag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG" class="md-nav__link">
    <span class="md-ellipsis">
      DAG
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.adjacency_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      adjacency_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.max_in_degree" class="md-nav__link">
    <span class="md-ellipsis">
      max_in_degree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.max_out_degree" class="md-nav__link">
    <span class="md-ellipsis">
      max_out_degree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.add_edge" class="md-nav__link">
    <span class="md-ellipsis">
      add_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.add_edges_from" class="md-nav__link">
    <span class="md-ellipsis">
      add_edges_from
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.children" class="md-nav__link">
    <span class="md-ellipsis">
      children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.from_nx" class="md-nav__link">
    <span class="md-ellipsis">
      from_nx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.from_pandas_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.induced_subgraph" class="md-nav__link">
    <span class="md-ellipsis">
      induced_subgraph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_acyclic" class="md-nav__link">
    <span class="md-ellipsis">
      is_acyclic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_adjacent" class="md-nav__link">
    <span class="md-ellipsis">
      is_adjacent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_clique" class="md-nav__link">
    <span class="md-ellipsis">
      is_clique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.load_drf" class="md-nav__link">
    <span class="md-ellipsis">
      load_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.remove_edge" class="md-nav__link">
    <span class="md-ellipsis">
      remove_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.remove_node" class="md-nav__link">
    <span class="md-ellipsis">
      remove_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag" class="md-nav__link">
    <span class="md-ellipsis">
      models_dag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.NodeAttributes" class="md-nav__link">
    <span class="md-ellipsis">
      NodeAttributes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell" class="md-nav__link">
    <span class="md-ellipsis">
      ProcessCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProcessCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.module_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      module_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.no_of_modules" class="md-nav__link">
    <span class="md-ellipsis">
      no_of_modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.__verify_edges_are_allowed" class="md-nav__link">
    <span class="md-ellipsis">
      __verify_edges_are_allowed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.add_module" class="md-nav__link">
    <span class="md-ellipsis">
      add_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.add_random_module" class="md-nav__link">
    <span class="md-ellipsis">
      add_random_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.connect_by_module" class="md-nav__link">
    <span class="md-ellipsis">
      connect_by_module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.connect_by_random_edges" class="md-nav__link">
    <span class="md-ellipsis">
      connect_by_random_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.get_available_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      get_available_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.input_cellgraph_directly" class="md-nav__link">
    <span class="md-ellipsis">
      input_cellgraph_directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.next_module_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      next_module_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProcessCell.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph" class="md-nav__link">
    <span class="md-ellipsis">
      ProductionLineGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProductionLineGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.between_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      between_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.eol_cell" class="md-nav__link">
    <span class="md-ellipsis">
      eol_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.ground_truth_visible" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth_visible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.interventions" class="md-nav__link">
    <span class="md-ellipsis">
      interventions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.within_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      within_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.connect_across_cells_manually" class="md-nav__link">
    <span class="md-ellipsis">
      connect_across_cells_manually
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.connect_cells" class="md-nav__link">
    <span class="md-ellipsis">
      connect_cells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.from_nx" class="md-nav__link">
    <span class="md-ellipsis">
      from_nx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      get_ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.get_nodes_of_station" class="md-nav__link">
    <span class="md-ellipsis">
      get_nodes_of_station
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.hidden_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      hidden_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.intervene_on" class="md-nav__link">
    <span class="md-ellipsis">
      intervene_on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.interventional_amat" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_amat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.load_drf" class="md-nav__link">
    <span class="md-ellipsis">
      load_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.load_pline_from_pickle" class="md-nav__link">
    <span class="md-ellipsis">
      load_pline_from_pickle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.new_cell" class="md-nav__link">
    <span class="md-ellipsis">
      new_cell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.sample_from_interventional_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_interventional_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.via_cell_number" class="md-nav__link">
    <span class="md-ellipsis">
      via_cell_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.ProductionLineGraph.visible_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      visible_nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.choose_edges_from_cells_randomly" class="md-nav__link">
    <span class="md-ellipsis">
      choose_edges_from_cells_randomly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_dag.get_arrow_head_candidates_from_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_arrow_head_candidates_from_graph
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils" class="md-nav__link">
    <span class="md-ellipsis">
      dag_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.merge_dags" class="md-nav__link">
    <span class="md-ellipsis">
      merge_dags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.merge_dags_via_edges" class="md-nav__link">
    <span class="md-ellipsis">
      merge_dags_via_edges
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag_utils.tuples_from_cartesian_product" class="md-nav__link">
    <span class="md-ellipsis">
      tuples_from_cartesian_product
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm" class="md-nav__link">
    <span class="md-ellipsis">
      models_fcm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM" class="md-nav__link">
    <span class="md-ellipsis">
      FCM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FCM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.ground_truth" class="md-nav__link">
    <span class="md-ellipsis">
      ground_truth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventions" class="md-nav__link">
    <span class="md-ellipsis">
      interventions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.source_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      source_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__distribution_parameters_explicit" class="md-nav__link">
    <span class="md-ellipsis">
      __distribution_parameters_explicit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__eval_expression" class="md-nav__link">
    <span class="md-ellipsis">
      __eval_expression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.__source_df_condition" class="md-nav__link">
    <span class="md-ellipsis">
      __source_df_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.causal_order_of" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.display_functions" class="md-nav__link">
    <span class="md-ellipsis">
      display_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.function_of" class="md-nav__link">
    <span class="md-ellipsis">
      function_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.input_fcm" class="md-nav__link">
    <span class="md-ellipsis">
      input_fcm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.intervene_on" class="md-nav__link">
    <span class="md-ellipsis">
      intervene_on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventional_amat" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_amat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.interventional_sample" class="md-nav__link">
    <span class="md-ellipsis">
      interventional_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.parents_of" class="md-nav__link">
    <span class="md-ellipsis">
      parents_of
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.show_mutilated_dag" class="md-nav__link">
    <span class="md-ellipsis">
      show_mutilated_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.models_fcm.FCM.source_nodes_of" class="md-nav__link">
    <span class="md-ellipsis">
      source_nodes_of
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics" class="md-nav__link">
    <span class="md-ellipsis">
      DAGmetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAGmetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.metrics.DAGmetrics.collect_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      collect_metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting" class="md-nav__link">
    <span class="md-ellipsis">
      drf_fitting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF" class="md-nav__link">
    <span class="md-ellipsis">
      DRF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DRF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.DRF.produce_sample" class="md-nav__link">
    <span class="md-ellipsis">
      produce_sample
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.drf_fitting.fit_drf" class="md-nav__link">
    <span class="md-ellipsis">
      fit_drf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag" class="md-nav__link">
    <span class="md-ellipsis">
      pdag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG" class="md-nav__link">
    <span class="md-ellipsis">
      PDAG
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PDAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.adjacency_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      adjacency_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.dir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      dir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.nnodes" class="md-nav__link">
    <span class="md-ellipsis">
      nnodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_adjacencies" class="md-nav__link">
    <span class="md-ellipsis">
      num_adjacencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_dir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_dir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.num_undir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_undir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_edges" class="md-nav__link">
    <span class="md-ellipsis">
      undir_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.children" class="md-nav__link">
    <span class="md-ellipsis">
      children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.from_pandas_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.is_adjacent" class="md-nav__link">
    <span class="md-ellipsis">
      is_adjacent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.is_clique" class="md-nav__link">
    <span class="md-ellipsis">
      is_clique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.remove_edge" class="md-nav__link">
    <span class="md-ellipsis">
      remove_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.remove_node" class="md-nav__link">
    <span class="md-ellipsis">
      remove_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_allDAGs" class="md-nav__link">
    <span class="md-ellipsis">
      to_allDAGs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_dag" class="md-nav__link">
    <span class="md-ellipsis">
      to_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.to_random_dag" class="md-nav__link">
    <span class="md-ellipsis">
      to_random_dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      undir_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.undir_to_dir_edge" class="md-nav__link">
    <span class="md-ellipsis">
      undir_to_dir_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.pdag.PDAG.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.dag2cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      dag2cpdag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_1" class="md-nav__link">
    <span class="md-ellipsis">
      rule_1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_2" class="md-nav__link">
    <span class="md-ellipsis">
      rule_2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_3" class="md-nav__link">
    <span class="md-ellipsis">
      rule_3
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.rule_4" class="md-nav__link">
    <span class="md-ellipsis">
      rule_4
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.pdag.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag" class="md-nav__link">
    <span class="md-ellipsis">
      dag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG" class="md-nav__link">
    <span class="md-ellipsis">
      DAG
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.adjacency_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      adjacency_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.causal_order" class="md-nav__link">
    <span class="md-ellipsis">
      causal_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.max_in_degree" class="md-nav__link">
    <span class="md-ellipsis">
      max_in_degree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.max_out_degree" class="md-nav__link">
    <span class="md-ellipsis">
      max_out_degree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.num_edges" class="md-nav__link">
    <span class="md-ellipsis">
      num_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.sparsity" class="md-nav__link">
    <span class="md-ellipsis">
      sparsity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.add_edge" class="md-nav__link">
    <span class="md-ellipsis">
      add_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.add_edges_from" class="md-nav__link">
    <span class="md-ellipsis">
      add_edges_from
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.children" class="md-nav__link">
    <span class="md-ellipsis">
      children
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.from_nx" class="md-nav__link">
    <span class="md-ellipsis">
      from_nx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.from_pandas_adjacency" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas_adjacency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.induced_subgraph" class="md-nav__link">
    <span class="md-ellipsis">
      induced_subgraph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_acyclic" class="md-nav__link">
    <span class="md-ellipsis">
      is_acyclic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_adjacent" class="md-nav__link">
    <span class="md-ellipsis">
      is_adjacent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.is_clique" class="md-nav__link">
    <span class="md-ellipsis">
      is_clique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.load_drf" class="md-nav__link">
    <span class="md-ellipsis">
      load_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.parents" class="md-nav__link">
    <span class="md-ellipsis">
      parents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.remove_edge" class="md-nav__link">
    <span class="md-ellipsis">
      remove_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.remove_node" class="md-nav__link">
    <span class="md-ellipsis">
      remove_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.sample_from_drf" class="md-nav__link">
    <span class="md-ellipsis">
      sample_from_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.save_drf" class="md-nav__link">
    <span class="md-ellipsis">
      save_drf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.to_cpdag" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpdag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalAssembly.dag.DAG.vstructs" class="md-nav__link">
    <span class="md-ellipsis">
      vstructs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Documentation</h1>

<p>Below, you will find the documentation of the
<code>causalAssembly</code> project code.</p>


<div class="doc doc-object doc-module">



<a id="causalAssembly.models_dag"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.models_dag.NodeAttributes" class="doc doc-heading">
            <code>NodeAttributes</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Node Attributes.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NodeAttributes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Node Attributes.&quot;&quot;&quot;</span>

    <span class="n">ALLOW_IN_EDGES</span> <span class="o">=</span> <span class="s2">&quot;allow_in_edges&quot;</span>
    <span class="n">HIDDEN</span> <span class="o">=</span> <span class="s2">&quot;is_hidden&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="causalAssembly.models_dag.ProcessCell" class="doc doc-heading">
            <code>ProcessCell</code>


</h2>


    <div class="doc doc-contents ">


        <p>Representation of a single Production Line Cell.</p>
<p>(to model a station / a process in a production line
environment).</p>
<p>A Cell can contain multiple modules (sub-graphs, which are nx.DiGraph objects).</p>
<p>Note that none of the term Cell, Process or Module has a strict definition.
The convention is based on a production line, consisting of several cells which
are to be modeled by means of smaller graphs (modules) by a user of the repository.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProcessCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a single Production Line Cell.</span>

<span class="sd">    (to model a station / a process in a production line</span>
<span class="sd">    environment).</span>

<span class="sd">    A Cell can contain multiple modules (sub-graphs, which are nx.DiGraph objects).</span>

<span class="sd">    Note that none of the term Cell, Process or Module has a strict definition.</span>
<span class="sd">    The convention is based on a production line, consisting of several cells which</span>
<span class="sd">    are to be modeled by means of smaller graphs (modules) by a user of the repository.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits Process cell class.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># description of the cell.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span> <span class="o">=</span> <span class="s2">&quot;M&quot;</span>  <span class="c1"># M01 vs M1?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># {&#39;M1&#39;: nx.DiGraph, &#39;M2&#39;: nx.DiGraph}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_connectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_eol</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sparsity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sparsity of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: in [0,1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_edges</span> <span class="o">/</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ground_truth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the current ground truth as pandas adjacency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Adjacenccy matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">causal_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the current graph.</span>

<span class="sd">        Note that this order is in general not unique.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: Causal order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            of_node (str): Node in question.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: parent set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">            location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">                the current working directory. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_module</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
        <span class="n">allow_in_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mark_hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds module to cell graph. Module has to be as nx.DiGraph object.</span>

<span class="sd">        Args:</span>
<span class="sd">            graph (nx.DiGraph): Graph to add to cell.</span>
<span class="sd">            allow_in_edges (bool, optional):</span>
<span class="sd">                whether nodes in the module are allowed to</span>
<span class="sd">                have in-edges. Defaults to True.</span>
<span class="sd">            mark_hidden (bool | list, optional):</span>
<span class="sd">                If False all nodes&#39; &#39;is_hidden&#39; attribute is set to False.</span>
<span class="sd">                If list of node names is provided these get overwritten to True.</span>
<span class="sd">                Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: prefix of Module created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">next_module_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_module_prefix</span><span class="p">()</span>

        <span class="n">node_renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">old_node_name</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">next_module_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">old_node_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">old_node_name</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">next_module_prefix</span><span class="p">()]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_renaming_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allow_in_edges</span><span class="p">:</span>  <span class="c1"># for later: mark nodes to not have incoming edges</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span>
            <span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span>
        <span class="p">)</span>  <span class="c1"># set all non-hidden -&gt; visible by default</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mark_hidden</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">mark_hidden_renamed</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">next_module_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="n">mark_hidden</span>
            <span class="p">]</span>
            <span class="n">overwrite_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">{</span><span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mark_hidden_renamed</span><span class="p">}</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span>
                <span class="n">graph</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">overwrite_dict</span>
            <span class="p">)</span>  <span class="c1"># only overwrite the ones specified</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">next_module_prefix</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">input_cellgraph_directly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow to input graphs on a cell-level.</span>

<span class="sd">        This should only be done if the graph</span>
<span class="sd">        is already available for the entire cell, otherwise `add_module()` is preferred.</span>

<span class="sd">        Args:</span>
<span class="sd">            graph (nx.DiGraph): Cell graph to input</span>
<span class="sd">            allow_in_edges (bool, optional): Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">allow_in_edges</span><span class="p">:</span>  <span class="c1"># for later: mark nodes to not have incoming edges</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>

        <span class="n">node_renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">old_node_name</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">old_node_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">old_node_name</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_renaming_dict</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">            smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">                be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_random_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a random DAG.</span>

<span class="sd">        By taking an arbitrary ordering of the specified number of nodes,</span>
<span class="sd">        and then considers edges from node i to j only if i &lt; j.</span>
<span class="sd">        That constraint leads to DAGness by construction.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_nodes (int, optional): Defaults to 5.</span>
<span class="sd">            p (float, optional): Defaults to .1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.DiGraph:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
        <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
        <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">dag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">))</span>

        <span class="n">causal_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">causal_order</span><span class="p">)</span>

        <span class="n">all_forward_edges</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">causal_order</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">all_forward_edges</span><span class="p">))</span>

        <span class="n">random_choice</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">random_choice</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dag</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_random_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add random module to the cell.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_nodes (int, optional): _description_. Defaults to 7.</span>
<span class="sd">            p (float, optional): _description_. Defaults to 0.10.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">randomdag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_dag</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">randomdag</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mark_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">connect_by_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">m2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Connect two modules.</span>

<span class="sd">        (by name, e.g. M2, M4) of the cell by a list</span>
<span class="sd">        of edges with the original node names.</span>

<span class="sd">        Args:</span>
<span class="sd">            m1: str</span>
<span class="sd">            m2: str</span>
<span class="sd">            edges: list[tuple]: use the original node names before they have entered into the cell,</span>
<span class="sd">                i.e. not with Cy_Mx prefix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__verify_edges_are_allowed</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>

        <span class="n">node_prefix_m1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">node_prefix_m2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">new_edges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_prefix_m1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_prefix_m2</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span>
        <span class="p">]</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">module_connectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">new_edges</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">new_edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">connect_by_random_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparsity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add random edges to graph.</span>

<span class="sd">        according to proportion</span>
<span class="sd">        with restriction specified in node attributes.</span>

<span class="sd">        Args:</span>
<span class="sd">            sparsity (float, optional): Sparsity parameter in (0,1). Defaults to 0.1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: when node attributes are not set.</span>
<span class="sd">            TypeError: when resulting graph contains cycles.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.DiGraph: DAG with new edges added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
        <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
        <span class="n">arrow_head_candidates</span> <span class="o">=</span> <span class="n">get_arrow_head_candidates_from_graph</span><span class="p">(</span>
            <span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="o">=</span><span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span>
        <span class="p">)</span>

        <span class="n">arrow_tail_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arrow_head_candidates</span><span class="p">]</span>

        <span class="n">potential_edges</span> <span class="o">=</span> <span class="n">tuples_from_cartesian_product</span><span class="p">(</span>
            <span class="n">l1</span><span class="o">=</span><span class="n">arrow_tail_candidates</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="n">arrow_head_candidates</span>
        <span class="p">)</span>
        <span class="n">num_choices</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">sparsity</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">)))</span>

        <span class="c1">### choose edges uniformly according to sparsity parameter</span>
        <span class="n">chosen_edges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">potential_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">num_choices</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">chosen_edges</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The randomly chosen edges induce cycles, this is not supposed to happen.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Repr method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ProcessCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Str method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cell_description</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Cell Name: &quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;Description:&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;n.a.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Modules:&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_of_modules</span><span class="p">,</span>
            <span class="s2">&quot;Nodes: &quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">info</span><span class="p">,</span> <span class="n">info_text</span> <span class="ow">in</span> <span class="n">cell_description</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">info</span><span class="si">:</span><span class="s2">&lt;14</span><span class="si">}{</span><span class="n">info_text</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__verify_edges_are_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">m2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether all starting point nodes (first value in edge tuple) are allowed.</span>

<span class="sd">        Args:</span>
<span class="sd">            m1 (str): Module1</span>
<span class="sd">            m2 (str): Module2</span>
<span class="sd">            edges (list[tuple]): Edges</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: starting node not in M1</span>
<span class="sd">            ValueError: ending node not in M2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>
        <span class="n">target_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>
        <span class="n">m1_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
        <span class="n">m2_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># type: ignore</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">source_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">m1_nodes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source nodes: </span><span class="si">{</span><span class="n">source_nodes</span><span class="si">}</span><span class="s2"> not include in </span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">s nodes: </span><span class="si">{</span><span class="n">m1_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">m2_nodes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;target nodes: </span><span class="si">{</span><span class="n">target_nodes</span><span class="si">}</span><span class="s2"> not include in </span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">s nodes: </span><span class="si">{</span><span class="n">m2_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">next_module_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the next module prefix, e.g.</span>

<span class="sd">        if there are already 3 modules connected to the cell,</span>
<span class="sd">        will return module_prefix4</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: module_prefix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">no_of_modules</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">module_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Module prefix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span>

    <span class="nd">@module_prefix</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">module_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_prefix</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;please only use strings as module prefix&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span> <span class="o">=</span> <span class="n">module_prefix</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">no_of_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of modules in the cell.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_available_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get available attributes of the nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">available_attributes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">attribute_name</span> <span class="ow">in</span> <span class="n">node_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">available_attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">attribute_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">available_attributes</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;To CPDAG conversion.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PDAG: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">meta_desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the cell graph.</span>

<span class="sd">        by giving extra weight to nodes</span>
<span class="sd">        with high in- and out-degree.</span>

<span class="sd">        Args:</span>
<span class="sd">            meta_desc (str, optional): Defaults to &quot;&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">max_in_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()])</span>
        <span class="n">max_out_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()])</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">node_color</span><span class="o">=</span><span class="p">[</span>
                <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_in_degree</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="p">],</span>
            <span class="n">node_size</span><span class="o">=</span><span class="p">[</span>
                <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_out_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
            <span class="p">],</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.2</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">meta_desc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_cellgraph</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">node_color</span><span class="p">,</span>
        <span class="n">node_size</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="n">with_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">meta_desc</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the cell graph.</span>

<span class="sd">        by giving extra weight to nodes</span>
<span class="sd">        with high in- and out-degree.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (_type_): _description_</span>
<span class="sd">            node_color (_type_): _description_</span>
<span class="sd">            node_size (_type_): _description_</span>
<span class="sd">            center (_type_, optional): _description_. Defaults to np.array([0, 0]).</span>
<span class="sd">            with_edges (bool, optional): _description_. Defaults to True.</span>
<span class="sd">            with_box (bool, optional): _description_. Defaults to True.</span>
<span class="sd">            meta_desc (str, optional): _description_. Defaults to &quot;&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">node_color</span><span class="o">=</span><span class="n">node_color</span><span class="p">,</span>
            <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">with_edges</span><span class="p">:</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
                <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.2</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">meta_desc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">with_box</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span>
                <span class="n">PatchCollection</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">FancyBboxPatch</span><span class="p">(</span>
                            <span class="n">center</span> <span class="o">-</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                            <span class="mi">4</span><span class="p">,</span>
                            <span class="mf">2.6</span><span class="p">,</span>
                            <span class="n">boxstyle</span><span class="o">=</span><span class="n">BoxStyle</span><span class="p">(</span><span class="s2">&quot;Round&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">],</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pos</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.causal_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">causal_order</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the causal order of the current graph.</p>
<p>Note that this order is in general not unique.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: Causal order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.ground_truth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ground_truth</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the current ground truth as pandas adjacency.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Adjacenccy matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.module_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">module_prefix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Module prefix.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.no_of_modules" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">no_of_modules</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of modules in the cell.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.num_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.num_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProcessCell.sparsity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sparsity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Sparsity of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in [0,1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Inits Process cell class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits Process cell class.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># description of the cell.</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span> <span class="o">=</span> <span class="s2">&quot;M&quot;</span>  <span class="c1"># M01 vs M1?</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># {&#39;M1&#39;: nx.DiGraph, &#39;M2&#39;: nx.DiGraph}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">module_connectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">is_eol</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Repr method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Repr method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ProcessCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Str method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Str method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cell_description</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Cell Name: &quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;Description:&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="k">else</span> <span class="s2">&quot;n.a.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Modules:&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_of_modules</span><span class="p">,</span>
        <span class="s2">&quot;Nodes: &quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">info</span><span class="p">,</span> <span class="n">info_text</span> <span class="ow">in</span> <span class="n">cell_description</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">info</span><span class="si">:</span><span class="s2">&lt;14</span><span class="si">}{</span><span class="n">info_text</span><span class="si">:</span><span class="s2">&gt;5</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.__verify_edges_are_allowed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__verify_edges_are_allowed</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check whether all starting point nodes (first value in edge tuple) are allowed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Module1</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Module2</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Edges</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>starting node not in M1</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ending node not in M2</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__verify_edges_are_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">m2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether all starting point nodes (first value in edge tuple) are allowed.</span>

<span class="sd">    Args:</span>
<span class="sd">        m1 (str): Module1</span>
<span class="sd">        m2 (str): Module2</span>
<span class="sd">        edges (list[tuple]): Edges</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: starting node not in M1</span>
<span class="sd">        ValueError: ending node not in M2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">source_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>
    <span class="n">target_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>
    <span class="n">m1_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># type: ignore</span>
    <span class="n">m2_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">m1_nodes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;source nodes: </span><span class="si">{</span><span class="n">source_nodes</span><span class="si">}</span><span class="s2"> not include in </span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">s nodes: </span><span class="si">{</span><span class="n">m1_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">m2_nodes</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;target nodes: </span><span class="si">{</span><span class="n">target_nodes</span><span class="si">}</span><span class="s2"> not include in </span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">s nodes: </span><span class="si">{</span><span class="n">m2_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.add_module" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_module</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mark_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds module to cell graph. Module has to be as nx.DiGraph object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graph to add to cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_in_edges</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether nodes in the module are allowed to
have in-edges. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mark_hidden</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False all nodes' 'is_hidden' attribute is set to False.
If list of node names is provided these get overwritten to True.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>prefix of Module created</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_module</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="n">allow_in_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">mark_hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds module to cell graph. Module has to be as nx.DiGraph object.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph (nx.DiGraph): Graph to add to cell.</span>
<span class="sd">        allow_in_edges (bool, optional):</span>
<span class="sd">            whether nodes in the module are allowed to</span>
<span class="sd">            have in-edges. Defaults to True.</span>
<span class="sd">        mark_hidden (bool | list, optional):</span>
<span class="sd">            If False all nodes&#39; &#39;is_hidden&#39; attribute is set to False.</span>
<span class="sd">            If list of node names is provided these get overwritten to True.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: prefix of Module created</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">next_module_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_module_prefix</span><span class="p">()</span>

    <span class="n">node_renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">old_node_name</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">next_module_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">old_node_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">old_node_name</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">next_module_prefix</span><span class="p">()]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_renaming_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">allow_in_edges</span><span class="p">:</span>  <span class="c1"># for later: mark nodes to not have incoming edges</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span>
        <span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span>
    <span class="p">)</span>  <span class="c1"># set all non-hidden -&gt; visible by default</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mark_hidden</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">mark_hidden_renamed</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">next_module_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="n">mark_hidden</span>
        <span class="p">]</span>
        <span class="n">overwrite_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">{</span><span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mark_hidden_renamed</span><span class="p">}</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span>
            <span class="n">graph</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">overwrite_dict</span>
        <span class="p">)</span>  <span class="c1"># only overwrite the ones specified</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">next_module_prefix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.add_random_module" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_random_module</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add random module to the cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_nodes</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to 7.</p>
              </div>
            </td>
            <td>
                  <code>7</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to 0.10.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_random_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add random module to the cell.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_nodes (int, optional): _description_. Defaults to 7.</span>
<span class="sd">        p (float, optional): _description_. Defaults to 0.10.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">randomdag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_dag</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">randomdag</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mark_hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.connect_by_module" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_by_module</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Connect two modules.</p>
<p>(by name, e.g. M2, M4) of the cell by a list
of edges with the original node names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>m1</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>m2</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]: use the original node names before they have entered into the cell,
i.e. not with Cy_Mx prefix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_by_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">m2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Connect two modules.</span>

<span class="sd">    (by name, e.g. M2, M4) of the cell by a list</span>
<span class="sd">    of edges with the original node names.</span>

<span class="sd">    Args:</span>
<span class="sd">        m1: str</span>
<span class="sd">        m2: str</span>
<span class="sd">        edges: list[tuple]: use the original node names before they have entered into the cell,</span>
<span class="sd">            i.e. not with Cy_Mx prefix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__verify_edges_are_allowed</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>

    <span class="n">node_prefix_m1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">node_prefix_m2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">new_edges</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_prefix_m1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_prefix_m2</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span>
    <span class="p">]</span>

    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">module_connectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">new_edges</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">new_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.connect_by_random_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_by_random_edges</span><span class="p">(</span><span class="n">sparsity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add random edges to graph.</p>
<p>according to proportion
with restriction specified in node attributes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sparsity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sparsity parameter in (0,1). Defaults to 0.1.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>when node attributes are not set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>when resulting graph contains cycles.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.DiGraph: DAG with new edges added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_by_random_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparsity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add random edges to graph.</span>

<span class="sd">    according to proportion</span>
<span class="sd">    with restriction specified in node attributes.</span>

<span class="sd">    Args:</span>
<span class="sd">        sparsity (float, optional): Sparsity parameter in (0,1). Defaults to 0.1.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: when node attributes are not set.</span>
<span class="sd">        TypeError: when resulting graph contains cycles.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.DiGraph: DAG with new edges added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
    <span class="k">if</span> <span class="n">rng</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
    <span class="n">arrow_head_candidates</span> <span class="o">=</span> <span class="n">get_arrow_head_candidates_from_graph</span><span class="p">(</span>
        <span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="o">=</span><span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span>
    <span class="p">)</span>

    <span class="n">arrow_tail_candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arrow_head_candidates</span><span class="p">]</span>

    <span class="n">potential_edges</span> <span class="o">=</span> <span class="n">tuples_from_cartesian_product</span><span class="p">(</span>
        <span class="n">l1</span><span class="o">=</span><span class="n">arrow_tail_candidates</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="n">arrow_head_candidates</span>
    <span class="p">)</span>
    <span class="n">num_choices</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">sparsity</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">)))</span>

    <span class="c1">### choose edges uniformly according to sparsity parameter</span>
    <span class="n">chosen_edges</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">potential_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">num_choices</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">chosen_edges</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;The randomly chosen edges induce cycles, this is not supposed to happen.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.get_available_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_available_attributes</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get available attributes of the nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_available_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get available attributes of the nodes in the graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">available_attributes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">node_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attribute_name</span> <span class="ow">in</span> <span class="n">node_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">available_attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">attribute_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">available_attributes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.input_cellgraph_directly" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_cellgraph_directly</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Allow to input graphs on a cell-level.</p>
<p>This should only be done if the graph
is already available for the entire cell, otherwise <code>add_module()</code> is preferred.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cell graph to input</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_in_edges</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">input_cellgraph_directly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Allow to input graphs on a cell-level.</span>

<span class="sd">    This should only be done if the graph</span>
<span class="sd">    is already available for the entire cell, otherwise `add_module()` is preferred.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph (nx.DiGraph): Cell graph to input</span>
<span class="sd">        allow_in_edges (bool, optional): Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allow_in_edges</span><span class="p">:</span>  <span class="c1"># for later: mark nodes to not have incoming edges</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span>

    <span class="n">node_renaming_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">old_node_name</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">old_node_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">old_node_name</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_renaming_dict</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.next_module_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">next_module_prefix</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the next module prefix, e.g.</p>
<p>if there are already 3 modules connected to the cell,
will return module_prefix4</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>module_prefix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">next_module_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the next module prefix, e.g.</span>

<span class="sd">    if there are already 3 modules connected to the cell,</span>
<span class="sd">    will return module_prefix4</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: module_prefix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__module_prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">no_of_modules</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.parents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return parents of node in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>of_node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node in question.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: parent set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        of_node (str): Node in question.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: parent set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.sample_from_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_from_drf</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Draw from the trained DRF.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be drawn. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smoothed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to true, marginal distributions will
be sampled from smoothed bootstraps. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">        smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">            be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.save_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_drf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes a drf dict to file. Please provide the .pkl suffix!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the file to be written e.g. examplefile.pkl</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to file in case it's not located in
the current working directory. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">        location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">            the current working directory. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="n">meta_desc</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the cell graph.</p>
<p>by giving extra weight to nodes
with high in- and out-degree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>meta_desc</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">meta_desc</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the cell graph.</span>

<span class="sd">    by giving extra weight to nodes</span>
<span class="sd">    with high in- and out-degree.</span>

<span class="sd">    Args:</span>
<span class="sd">        meta_desc (str, optional): Defaults to &quot;&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">max_in_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()])</span>
    <span class="n">max_out_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()])</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="p">[</span>
            <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_in_degree</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="p">],</span>
        <span class="n">node_size</span><span class="o">=</span><span class="p">[</span>
            <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_out_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="p">],</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.2</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">meta_desc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProcessCell.to_cpdag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_cpdag</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>To CPDAG conversion.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To CPDAG conversion.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="causalAssembly.models_dag.ProductionLineGraph" class="doc doc-heading">
            <code>ProductionLineGraph</code>


</h2>


    <div class="doc doc-contents ">


        <p>Blueprint of a Production Line Graph.</p>
<p>A Production Line consists of multiple Cells, each Cell can contain multiple modules.
Modules can be instantiated randomly or manually. Cellgraphs and linegraphs can be
instantiated directly from nx.DiGraph objects. Similarly, edges can be drawn at random
(obeying certain probability choices that can be set by the user) between cells/moduls
or manually.</p>
<p>Besides populating a production line with cell/module-graphs one can obtain
semi-synthetic data obeying the standard causal assumptions:</p>
<pre><code>1. Markov Property
2. Faithfulness
</code></pre>
<p>This can be achieved by fitting distributional random forests to the line/cell-graphs
and draw data from these. A random number stream is initiated when calling this class.
If desired this can be overwritten manually.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ProductionLineGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Blueprint of a Production Line Graph.</span>

<span class="sd">    A Production Line consists of multiple Cells, each Cell can contain multiple modules.</span>
<span class="sd">    Modules can be instantiated randomly or manually. Cellgraphs and linegraphs can be</span>
<span class="sd">    instantiated directly from nx.DiGraph objects. Similarly, edges can be drawn at random</span>
<span class="sd">    (obeying certain probability choices that can be set by the user) between cells/moduls</span>
<span class="sd">    or manually.</span>

<span class="sd">    Besides populating a production line with cell/module-graphs one can obtain</span>
<span class="sd">    semi-synthetic data obeying the standard causal assumptions:</span>

<span class="sd">        1. Markov Property</span>
<span class="sd">        2. Faithfulness</span>

<span class="sd">    This can be achieved by fitting distributional random forests to the line/cell-graphs</span>
<span class="sd">    and draw data from these. A random number stream is initiated when calling this class.</span>
<span class="sd">    If desired this can be overwritten manually.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits ProductionLineGraph.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            TypeError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            ValueError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            ValueError: _description_</span>
<span class="sd">            ValueError: _description_</span>
<span class="sd">            ValueError: _description_</span>
<span class="sd">            TypeError: _description_</span>
<span class="sd">            AssertionError: _description_</span>
<span class="sd">            AttributeError: _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProcessCell</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_prefix</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_connectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interventional_drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_mutilated_dag</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Random state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>

    <span class="nd">@random_state</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Specify numpy random number generator object!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">r</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_mutilated_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a nx.DiGraph object of the actual graph.</span>

<span class="sd">        The graph is only built HERE, i.e. all ProcessCells exist standalone in self.cells,</span>
<span class="sd">        with no connections between their nodes yet.</span>

<span class="sd">        The edges are stored in self.cell_connetor_edges, where they are added by random methods</span>
<span class="sd">        or by user (the dag builder) himself.</span>

<span class="sd">        ATTENTION: you can not work on self.graph and add manually edges, nodes and expect them to</span>
<span class="sd">        work.</span>

<span class="sd">        Returns nx.DiGraph</span>

<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

        <span class="n">g</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;There are cycles in the graph, </span><span class="se">\</span>
<span class="s2">                this is not supposed to happen.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">g</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sparsity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sparsity of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: in [0,1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_edges</span> <span class="o">/</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ground_truth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the current ground truth as pandas adjacency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Adjacenccy matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_union_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Your pline has no cells. Within has no meaning.&quot;</span><span class="p">)</span>
        <span class="n">union_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">station_graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">union_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">union_graph</span><span class="p">,</span> <span class="n">station_graph</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">union_graph</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">within_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns adjacency matrix ignoring all between-cell edges.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: adjacency matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">union_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_union_graph</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">union_graph</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">between_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns adjacency matrix ignoring all within-cell edges.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: adjacency matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">union_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_union_graph</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">union_graph</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">causal_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the current graph.</span>

<span class="sd">        Note that this order is in general not unique.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: Causal order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            of_node (str): Node in question.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: parent set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to CPDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PDAG: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_nodes_of_station</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns nodes in chosen Station.</span>

<span class="sd">        Args:</span>
<span class="sd">            station_name (str): name of station.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: if station name doesn&#39;t match pline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: nodes in chosen station</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">station_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Station name not among cells.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__add_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">:</span> <span class="n">ProcessCell</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProcessCell</span><span class="p">:</span>
        <span class="n">cell_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">cell_name</span> <span class="k">for</span> <span class="n">cell_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">is_eol</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">cell</span><span class="o">.</span><span class="n">is_eol</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cell: </span><span class="si">{</span><span class="p">[</span><span class="n">cell</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">cell</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cell</span><span class="o">.</span><span class="n">is_eol</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is already EOL Cell in ProductionLineGraph.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cell_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">cell</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span>

            <span class="k">return</span> <span class="n">cell</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A cell with name: </span><span class="si">{</span><span class="n">cell</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is already in the Production Line.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">new_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_eol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProcessCell</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new cell to the production line.</span>

<span class="sd">        If no name is given, cell name is given by counting available cells + 1</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str, optional): Defaults to None.</span>
<span class="sd">            is_eol (bool, optional): Whether cell is end-of-line. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ProcessCell</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">ProcessCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">actual_no_of_cells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">ProcessCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_prefix</span><span class="si">}{</span><span class="n">actual_no_of_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">c</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>  <span class="c1"># type: ignore</span>

        <span class="n">c</span><span class="o">.</span><span class="n">is_eol</span> <span class="o">=</span> <span class="n">is_eol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__add_cell</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">connect_cells</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">forward_probs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Randomly connects cells in a ProductionLineGraph according to a forwards logic.</span>

<span class="sd">        Args:</span>
<span class="sd">            forward_probs (list[float], optional): Array of sparsity scalars of</span>
<span class="sd">                dimension max_forward. Defaults to [0.1, 0.05].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># assume cells are initiated in order</span>
        <span class="c1"># otherwise allow to change order</span>

        <span class="n">max_forward</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">forward_probs</span><span class="p">)</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">no_of_cells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">cell_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">prob_it</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># prob it(erator)</span>

            <span class="k">for</span> <span class="n">forwards</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_forward</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">forward_cell_idx</span> <span class="o">=</span> <span class="n">cell_idx</span> <span class="o">+</span> <span class="n">forwards</span>

                <span class="k">if</span> <span class="n">forward_cell_idx</span> <span class="o">&lt;</span> <span class="n">no_of_cells</span><span class="p">:</span>
                    <span class="n">forward_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">forward_cell_idx</span><span class="p">]</span>
                    <span class="n">chosen_edges</span> <span class="o">=</span> <span class="n">choose_edges_from_cells_randomly</span><span class="p">(</span>
                        <span class="n">from_cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span>
                        <span class="n">to_cell</span><span class="o">=</span><span class="n">forward_cell</span><span class="p">,</span>
                        <span class="n">probability</span><span class="o">=</span><span class="n">forward_probs</span><span class="p">[</span><span class="n">prob_it</span><span class="p">],</span>
                        <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">prob_it</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chosen_edges</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eol_cell</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eol_cell</span><span class="p">:</span>
                <span class="n">eol_cell_idx</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">eol_cell</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">cell_idx</span> <span class="o">+</span> <span class="n">max_forward</span> <span class="o">&lt;</span> <span class="n">eol_cell_idx</span><span class="p">:</span>
                    <span class="n">eol_prob</span> <span class="o">=</span> <span class="n">forward_probs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">chosen_eol_edges</span> <span class="o">=</span> <span class="n">choose_edges_from_cells_randomly</span><span class="p">(</span>
                        <span class="n">from_cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span>
                        <span class="n">to_cell</span><span class="o">=</span><span class="n">eol_cell</span><span class="p">,</span>
                        <span class="n">probability</span><span class="o">=</span><span class="n">eol_prob</span><span class="p">,</span>
                        <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chosen_eol_edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProductionLineGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes a full copy of the current ProductionLineGraph object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ProductionLineGraph: copyied object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">copy_graph</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">:</span>
            <span class="n">copy_graph</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
            <span class="c1"># make sure its sorted</span>
            <span class="n">sorted_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
            <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="p">)</span>
            <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
            <span class="n">copy_graph</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">sorted_graph</span>

        <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">copy_graph</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
        <span class="n">copy_graph</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copy_graph</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">connect_across_cells_manually</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add edges manually across cells.</span>

<span class="sd">        You need to give the full name</span>
<span class="sd">        Args:</span>
<span class="sd">            edges (list[tuple]): list of edges to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">intervene_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RandomSymbol</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Specify hard or soft intervention.</span>

<span class="sd">        If you want to intervene</span>
<span class="sd">        upon more than one node provide a list of nodes to intervene on</span>
<span class="sd">        and a list of corresponding values to set these nodes to.</span>
<span class="sd">        (see example). The mutilated dag will automatically be</span>
<span class="sd">        stored in `mutiliated_dags`.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes_values (dict[str, RandomSymbol | float]): either single real</span>
<span class="sd">                number or sympy.stats.RandomSymbol. If you like to intervene on</span>
<span class="sd">                more than one node, just provide more key-value pairs.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If node(s) are not in the graph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;You need to train a drf first.&quot;</span><span class="p">)</span>
        <span class="n">drf_replace</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;One or more nodes you want to intervene upon are not in the graph.&quot;</span>
            <span class="p">)</span>

        <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">nodes_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">old_incoming</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
            <span class="n">edges_to_remove</span> <span class="o">=</span> <span class="p">[(</span><span class="n">old</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">old</span> <span class="ow">in</span> <span class="n">old_incoming</span><span class="p">]</span>
            <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">edges_to_remove</span><span class="p">)</span>
            <span class="n">drf_replace</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">mutilated_dag</span>  <span class="c1"># specifiying the same set twice will override</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interventional_drf</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">drf_replace</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interventions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all interventions performed on the original graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of intervened upon nodes in do(x) notation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interventional_amat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the adjacency matrix of a chosen mutilated DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            which_intervention (int | str): Integer count of your chosen intervention or</span>
<span class="sd">                literal string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: &quot;The intervention you provide does not exist.&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Adjacency matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you provide does not exist.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you index does not exist.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

        <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">mutilated_dag</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ground_truth</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProductionLineGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads in the ground_truth as described in the paper.</span>

<span class="sd">        causalAssembly: Generating Realistic Production Data for</span>
<span class="sd">        Benchmarking Causal Discovery</span>
<span class="sd">        Returns:</span>
<span class="sd">            ProductionLineGraph: ground_truth for cells and line.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gt_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">DATA_GROUND_TRUTH</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">gt_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="n">assembly_line</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">adjacency_graph</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">)</span>

        <span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Station1&quot;</span><span class="p">,</span> <span class="s2">&quot;Station2&quot;</span><span class="p">,</span> <span class="s2">&quot;Station3&quot;</span><span class="p">,</span> <span class="s2">&quot;Station4&quot;</span><span class="p">,</span> <span class="s2">&quot;Station5&quot;</span><span class="p">]</span>
        <span class="n">ground_truth_line</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
            <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
            <span class="n">station_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">assembly_line</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">station</span><span class="p">)]</span>
            <span class="n">station_subgraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">assembly_line</span><span class="p">,</span> <span class="n">station_nodes</span><span class="p">)</span>
            <span class="c1"># make sure its sorted</span>
            <span class="n">sorted_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
            <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="n">station_nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="p">)</span>
            <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">station_subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
            <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">sorted_graph</span>

        <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">assembly_line</span><span class="p">,</span> <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
        <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ground_truth_line</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load in semi-synthetic data as described in the paper.</span>

<span class="sd">        causalAssembly: Generating Realistic Production Data for</span>
<span class="sd">        Benchmarking Causal Discovery</span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data from which data should be generated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA_DATASET</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_nx</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">cell_mapper</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert nx.DiGraph to ProductionLineGraph.</span>

<span class="sd">        Requires a dict mapping</span>
<span class="sd">        where keys are cell names and values correspond to nodes within these cells.</span>

<span class="sd">        Args:</span>
<span class="sd">            g (nx.DiGraph): graph to be converted</span>
<span class="sd">            cell_mapper (dict[str, list]): dict to indicate what nodes belong to which cell</span>

<span class="sd">        Returns:</span>
<span class="sd">            ProductionLineGraph (ProductionLineGraph): the graph as a ProductionLineGraph object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph must be of type nx.DiGraph&quot;</span><span class="p">)</span>
        <span class="n">pline</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cell_mapper</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cellname</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">cell_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">pline</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">cellname</span><span class="p">)</span>
                <span class="n">cell_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
                <span class="n">pline</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">cellname</span><span class="p">]</span><span class="o">.</span><span class="n">input_cellgraph_directly</span><span class="p">(</span><span class="n">cell_graph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">relabel_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">cellname</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">cell_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">relabel_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">cellname</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>

        <span class="n">g_rename</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">relabel_dict</span><span class="p">)</span>
        <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">g_rename</span><span class="p">,</span> <span class="n">pline</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
        <span class="n">pline</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pline</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_drf</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads a drf dict from a .pkl file into the workspace.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): name of the file e.g. examplefile.pkl</span>
<span class="sd">            location (str, optional): path to file in case it&#39;s not located</span>
<span class="sd">                in the current working directory. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DRF (dict): dict of trained drf objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">drf</span><span class="p">:</span>
            <span class="n">pickle_drf</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">drf</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pickle_drf</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_pline_from_pickle</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load production line graph from a pickle file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): _description_</span>
<span class="sd">            location (str | Path | None, optional): _description_. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pline</span><span class="p">:</span>
            <span class="n">pickle_line</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pline</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pickle_line</span><span class="p">,</span> <span class="n">ProductionLineGraph</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You didn&#39;t refer to a ProductionLineGraph.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pickle_line</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">            location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">                the current working directory. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">            smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">                be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_from_interventional_drf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw from the trained and intervened upon DRF.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">            which_intervention (str | int): Which intervention to choose from.</span>
<span class="sd">                Both the literal name (see the property `interventions`) and the index</span>
<span class="sd">                are possible. Defaults to the first intervention.</span>
<span class="sd">            smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">                be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame that follows the interventional distribution</span>
<span class="sd">                implied by the ground truth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_interventional_sample_from_drf</span><span class="p">(</span>
            <span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="o">=</span><span class="n">which_intervention</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hidden_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns list of nodes marked as hidden.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: of hidden nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">node</span>
            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">hidden</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">hidden</span> <span class="ow">is</span> <span class="kc">True</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visible_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;All visible nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">()]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eol_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProcessCell</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns ProcessCell.</span>

<span class="sd">        the EOL cell</span>
<span class="sd">            (if any single cell has attr .is_eol = True), otherwise returns None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">is_eol</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cell</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ground_truth_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a ground truth graph in form of a pandas adjacency matrix.</span>

<span class="sd">        Row and column names correspond to visible.</span>
<span class="sd">        The following integers can occur:</span>

<span class="sd">        amat[i,j] = 1 indicates i -&gt; j</span>
<span class="sd">        amat[i,j] = 0 indicates no edge</span>
<span class="sd">        amat[i,j] = amat[j,i] = 2 indicates i &lt;-&gt; j and there exists a common hidden confounder</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: amat with values in {0,1,2}.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_truth</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mediators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pairs_with_hidden_mediators</span><span class="p">()</span>
            <span class="n">confounders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pairs_with_hidden_confounders</span><span class="p">()</span>

            <span class="c1"># here 1 indicates that ROWS has edge to COLUMNS!</span>
            <span class="n">amat</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
            <span class="n">amat_visible</span> <span class="o">=</span> <span class="n">amat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">visible_nodes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_nodes</span><span class="p">()]</span>

            <span class="k">for</span> <span class="n">pairs</span> <span class="ow">in</span> <span class="n">mediators</span><span class="p">:</span>
                <span class="n">amat_visible</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pairs</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># reverse = lambda tuples: tuples[::-1]</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">reverse</span><span class="p">(</span><span class="n">tuples</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Simple function to reverse tuple order.</span>

<span class="sd">                Args:</span>
<span class="sd">                    tuples (tuple): tuple to reverse order</span>

<span class="sd">                Returns:</span>
<span class="sd">                    tuple: tuple in reversed order</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">new_tup</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">new_tup</span>

            <span class="k">for</span> <span class="n">pair</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">confounders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">amat_visible</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">amat_visible</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">reverse</span><span class="p">(</span><span class="n">pair</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>

            <span class="k">return</span> <span class="n">amat_visible</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta_description</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot full assembly line.</span>

<span class="sd">        Args:</span>
<span class="sd">            meta_description (list | None, optional): Specify additional cell info.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            fig_size (tuple, optional): Adjust depending on number of cells.</span>
<span class="sd">                Defaults to (15, 8).</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: Meta list entry needs to exist for each cell!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">meta_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">meta_description</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">))]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_description</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Meta list entry needs to exist for each cell!&quot;</span><span class="p">)</span>

        <span class="n">max_in_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()])</span>
        <span class="n">max_out_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">station_name</span><span class="p">,</span> <span class="n">meta_desc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">,</span> <span class="n">meta_description</span><span class="p">)):</span>
            <span class="n">pos</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span><span class="o">.</span><span class="n">_plot_cellgraph</span><span class="p">(</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">with_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">with_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">meta_desc</span><span class="o">=</span><span class="n">meta_desc</span><span class="p">,</span>
                    <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                    <span class="n">node_color</span><span class="o">=</span><span class="p">[</span>
                        <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_in_degree</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nodes_of_station</span><span class="p">(</span><span class="n">station_name</span><span class="p">))</span>
                    <span class="p">],</span>
                    <span class="n">node_size</span><span class="o">=</span><span class="p">[</span>
                        <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_out_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nodes_of_station</span><span class="p">(</span><span class="n">station_name</span><span class="p">))</span>
                    <span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String method for ProductionLineGraph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ProductionLine</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a cell by its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            attrname (_type_): _description_</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attrname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attrname</span><span class="si">}</span><span class="s2"> is not a valid attribute (cell name?)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current state of the ProductionLineGraph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set state of the ProductionLineGraph.</span>

<span class="sd">        Args:</span>
<span class="sd">            state (_type_): _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="n">state</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">via_cell_number</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n_cells</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cell_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits a ProductionLineGraph with predefined number of cells, e.g. n_cells = 3.</span>

<span class="sd">        Will create empty  C0, C1 and C2 as cells if no other cell_prefix is given.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_cells (int): Number of cells the graph will have</span>
<span class="sd">            cell_prefix (str, optional): If you like other cell names pass them here.</span>
<span class="sd">                Defaults to &quot;C&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pl</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">cell_prefix</span> <span class="o">=</span> <span class="n">cell_prefix</span>

        <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">new_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">pl</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_pairs_with_hidden_mediators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return pairs of nodes with hidden mediators present.</span>

<span class="sd">        Args:</span>
<span class="sd">            graph (nx.DiGraph): DAG</span>
<span class="sd">            visible (list): list of visible nodes</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of tuples with pairs of nodes with hidden mediator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">TWO</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">any_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_nodes</span><span class="p">()</span>
        <span class="n">hidden_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">()</span>
        <span class="n">confounders</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pairs_with_hidden_confounders</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">hidden_all</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">confounders</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">visible</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">visible</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">visible</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">visible</span><span class="p">[</span><span class="n">j</span><span class="p">])):</span>
                    <span class="n">any_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">pairs_with_hidden_mediators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">any_paths</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hidden</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">TWO</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">pairs_with_hidden_mediators</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_pairs_with_hidden_confounders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns node-pairs that have a common hidden confounder.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary with keys equal to tuples of node-pairs</span>
<span class="sd">            and values their corresponding hidden confounder(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">confounder_pairs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_nodes</span><span class="p">()</span>
        <span class="n">pair_order_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">visible</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">pair_order_list</span><span class="p">:</span>
            <span class="n">ancestors1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node1</span><span class="p">)</span>
            <span class="n">ancestors2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ancestors1</span><span class="p">),</span> <span class="n">visible</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ancestors2</span><span class="p">),</span> <span class="n">visible</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                    <span class="p">),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">):</span>  <span class="c1"># annoying way of doing this. List comparison doesn&#39;t allow elementwise eval</span>
                <span class="n">confounder</span> <span class="o">=</span> <span class="n">ancestors1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ancestors2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">confounder</span><span class="p">:</span>  <span class="c1"># only populate if set is non-empty</span>
                    <span class="n">confounder_pairs</span><span class="p">[(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">confounder</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">direct_parents1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node1</span><span class="p">))</span>
                <span class="n">direct_parents2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node2</span><span class="p">))</span>
                <span class="n">direct_confounder</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">node</span>
                    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">direct_parents1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">direct_parents2</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visible</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">direct_confounder</span><span class="p">:</span>
                    <span class="n">confounder_pairs</span><span class="p">[(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">direct_confounder</span>

        <span class="k">return</span> <span class="n">confounder_pairs</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.between_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">between_adjacency</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns adjacency matrix ignoring all within-cell edges.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: adjacency matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.causal_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">causal_order</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the causal order of the current graph.</p>
<p>Note that this order is in general not unique.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: Causal order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.eol_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eol_cell</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns ProcessCell.</p>
<p>the EOL cell
    (if any single cell has attr .is_eol = True), otherwise returns None</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">graph</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a nx.DiGraph object of the actual graph.</p>
<p>The graph is only built HERE, i.e. all ProcessCells exist standalone in self.cells,
with no connections between their nodes yet.</p>
<p>The edges are stored in self.cell_connetor_edges, where they are added by random methods
or by user (the dag builder) himself.</p>
<p>ATTENTION: you can not work on self.graph and add manually edges, nodes and expect them to
work.</p>
<p>Returns nx.DiGraph</p>
<hr />

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.ground_truth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ground_truth</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the current ground truth as pandas adjacency.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Adjacenccy matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.ground_truth_visible" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ground_truth_visible</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a ground truth graph in form of a pandas adjacency matrix.</p>
<p>Row and column names correspond to visible.
The following integers can occur:</p>
<p>amat[i,j] = 1 indicates i -&gt; j
amat[i,j] = 0 indicates no edge
amat[i,j] = amat[j,i] = 2 indicates i &lt;-&gt; j and there exists a common hidden confounder</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: amat with values in {0,1,2}.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.interventions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interventions</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns all interventions performed on the original graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of intervened upon nodes in do(x) notation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.num_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.num_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.random_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_state</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Random state.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.sparsity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sparsity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Sparsity of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in [0,1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_dag.ProductionLineGraph.within_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">within_adjacency</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns adjacency matrix ignoring all between-cell edges.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: adjacency matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a cell by its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>attrname</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a cell by its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        attrname (_type_): _description_</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">attrname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attrname</span><span class="si">}</span><span class="s2"> is not a valid attribute (cell name?)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.__getstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__getstate__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get current state of the ProductionLineGraph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current state of the ProductionLineGraph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Inits ProductionLineGraph.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits ProductionLineGraph.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        TypeError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        ValueError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        ValueError: _description_</span>
<span class="sd">        ValueError: _description_</span>
<span class="sd">        ValueError: _description_</span>
<span class="sd">        TypeError: _description_</span>
<span class="sd">        AssertionError: _description_</span>
<span class="sd">        AttributeError: _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProcessCell</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_prefix</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_connectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interventional_drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__init_mutilated_dag</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set state of the ProductionLineGraph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set state of the ProductionLineGraph.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>String method for ProductionLineGraph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;String method for ProductionLineGraph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ProductionLine</span><span class="se">\n\n</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.connect_across_cells_manually" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add edges manually across cells.</p>
<p>You need to give the full name
Args:
    edges (list[tuple]): list of edges to add</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_across_cells_manually</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add edges manually across cells.</span>

<span class="sd">    You need to give the full name</span>
<span class="sd">    Args:</span>
<span class="sd">        edges (list[tuple]): list of edges to add</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.connect_cells" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_cells</span><span class="p">(</span><span class="n">forward_probs</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Randomly connects cells in a ProductionLineGraph according to a forwards logic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forward_probs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of sparsity scalars of
dimension max_forward. Defaults to [0.1, 0.05].</p>
              </div>
            </td>
            <td>
                  <code>[0.1, 0.05]</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_cells</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">forward_probs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly connects cells in a ProductionLineGraph according to a forwards logic.</span>

<span class="sd">    Args:</span>
<span class="sd">        forward_probs (list[float], optional): Array of sparsity scalars of</span>
<span class="sd">            dimension max_forward. Defaults to [0.1, 0.05].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># assume cells are initiated in order</span>
    <span class="c1"># otherwise allow to change order</span>

    <span class="n">max_forward</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">forward_probs</span><span class="p">)</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">no_of_cells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">cell_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
        <span class="n">prob_it</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># prob it(erator)</span>

        <span class="k">for</span> <span class="n">forwards</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_forward</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">forward_cell_idx</span> <span class="o">=</span> <span class="n">cell_idx</span> <span class="o">+</span> <span class="n">forwards</span>

            <span class="k">if</span> <span class="n">forward_cell_idx</span> <span class="o">&lt;</span> <span class="n">no_of_cells</span><span class="p">:</span>
                <span class="n">forward_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">forward_cell_idx</span><span class="p">]</span>
                <span class="n">chosen_edges</span> <span class="o">=</span> <span class="n">choose_edges_from_cells_randomly</span><span class="p">(</span>
                    <span class="n">from_cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span>
                    <span class="n">to_cell</span><span class="o">=</span><span class="n">forward_cell</span><span class="p">,</span>
                    <span class="n">probability</span><span class="o">=</span><span class="n">forward_probs</span><span class="p">[</span><span class="n">prob_it</span><span class="p">],</span>
                    <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">prob_it</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chosen_edges</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">eol_cell</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eol_cell</span><span class="p">:</span>
            <span class="n">eol_cell_idx</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">eol_cell</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cell_idx</span> <span class="o">+</span> <span class="n">max_forward</span> <span class="o">&lt;</span> <span class="n">eol_cell_idx</span><span class="p">:</span>
                <span class="n">eol_prob</span> <span class="o">=</span> <span class="n">forward_probs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">chosen_eol_edges</span> <span class="o">=</span> <span class="n">choose_edges_from_cells_randomly</span><span class="p">(</span>
                    <span class="n">from_cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span>
                    <span class="n">to_cell</span><span class="o">=</span><span class="n">eol_cell</span><span class="p">,</span>
                    <span class="n">probability</span><span class="o">=</span><span class="n">eol_prob</span><span class="p">,</span>
                    <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">cell_connector_edges</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chosen_eol_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Makes a full copy of the current ProductionLineGraph object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ProductionLineGraph</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="ProductionLineGraph (causalAssembly.models_dag.ProductionLineGraph)" href="#causalAssembly.models_dag.ProductionLineGraph">ProductionLineGraph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>copyied object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProductionLineGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a full copy of the current ProductionLineGraph object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ProductionLineGraph: copyied object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copy_graph</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">:</span>
        <span class="n">copy_graph</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
        <span class="c1"># make sure its sorted</span>
        <span class="n">sorted_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="n">copy_graph</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">sorted_graph</span>

    <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">copy_graph</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">copy_graph</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">copy_graph</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.from_nx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_nx</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">cell_mapper</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Convert nx.DiGraph to ProductionLineGraph.</p>
<p>Requires a dict mapping
where keys are cell names and values correspond to nodes within these cells.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>g</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>graph to be converted</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_mapper</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict to indicate what nodes belong to which cell</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ProductionLineGraph</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="ProductionLineGraph (causalAssembly.models_dag.ProductionLineGraph)" href="#causalAssembly.models_dag.ProductionLineGraph">ProductionLineGraph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the graph as a ProductionLineGraph object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_nx</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">cell_mapper</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert nx.DiGraph to ProductionLineGraph.</span>

<span class="sd">    Requires a dict mapping</span>
<span class="sd">    where keys are cell names and values correspond to nodes within these cells.</span>

<span class="sd">    Args:</span>
<span class="sd">        g (nx.DiGraph): graph to be converted</span>
<span class="sd">        cell_mapper (dict[str, list]): dict to indicate what nodes belong to which cell</span>

<span class="sd">    Returns:</span>
<span class="sd">        ProductionLineGraph (ProductionLineGraph): the graph as a ProductionLineGraph object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph must be of type nx.DiGraph&quot;</span><span class="p">)</span>
    <span class="n">pline</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cell_mapper</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cellname</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">cell_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">pline</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">cellname</span><span class="p">)</span>
            <span class="n">cell_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
            <span class="n">pline</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">cellname</span><span class="p">]</span><span class="o">.</span><span class="n">input_cellgraph_directly</span><span class="p">(</span><span class="n">cell_graph</span><span class="p">,</span> <span class="n">allow_in_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">relabel_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">cellname</span><span class="p">,</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">cell_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">relabel_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">cellname</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>

    <span class="n">g_rename</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">relabel_dict</span><span class="p">)</span>
    <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">g_rename</span><span class="p">,</span> <span class="n">pline</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">pline</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pline</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.get_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_data</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Load in semi-synthetic data as described in the paper.</p>
<p>causalAssembly: Generating Realistic Production Data for
Benchmarking Causal Discovery
Returns:
    pd.DataFrame: Data from which data should be generated.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load in semi-synthetic data as described in the paper.</span>

<span class="sd">    causalAssembly: Generating Realistic Production Data for</span>
<span class="sd">    Benchmarking Causal Discovery</span>
<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data from which data should be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA_DATASET</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.get_ground_truth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ground_truth</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Loads in the ground_truth as described in the paper.</p>
<p>causalAssembly: Generating Realistic Production Data for
Benchmarking Causal Discovery
Returns:
    ProductionLineGraph: ground_truth for cells and line.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ground_truth</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProductionLineGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads in the ground_truth as described in the paper.</span>

<span class="sd">    causalAssembly: Generating Realistic Production Data for</span>
<span class="sd">    Benchmarking Causal Discovery</span>
<span class="sd">    Returns:</span>
<span class="sd">        ProductionLineGraph: ground_truth for cells and line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gt_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">DATA_GROUND_TRUTH</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">gt_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="n">assembly_line</span> <span class="o">=</span> <span class="n">json_graph</span><span class="o">.</span><span class="n">adjacency_graph</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">)</span>

    <span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Station1&quot;</span><span class="p">,</span> <span class="s2">&quot;Station2&quot;</span><span class="p">,</span> <span class="s2">&quot;Station3&quot;</span><span class="p">,</span> <span class="s2">&quot;Station4&quot;</span><span class="p">,</span> <span class="s2">&quot;Station5&quot;</span><span class="p">]</span>
    <span class="n">ground_truth_line</span> <span class="o">=</span> <span class="n">ProductionLineGraph</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
        <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
        <span class="n">station_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">assembly_line</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">station</span><span class="p">)]</span>
        <span class="n">station_subgraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">assembly_line</span><span class="p">,</span> <span class="n">station_nodes</span><span class="p">)</span>
        <span class="c1"># make sure its sorted</span>
        <span class="n">sorted_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">station_nodes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="n">sorted_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">station_subgraph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">sorted_graph</span>

    <span class="n">between_cell_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">assembly_line</span><span class="p">,</span> <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">ground_truth_line</span><span class="o">.</span><span class="n">connect_across_cells_manually</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">between_cell_edges</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ground_truth_line</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.get_nodes_of_station" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_nodes_of_station</span><span class="p">(</span><span class="n">station_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns nodes in chosen Station.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>station_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of station.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if station name doesn't match pline.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nodes in chosen station</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_nodes_of_station</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns nodes in chosen Station.</span>

<span class="sd">    Args:</span>
<span class="sd">        station_name (str): name of station.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: if station name doesn&#39;t match pline.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: nodes in chosen station</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">station_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Station name not among cells.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.hidden_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hidden_nodes</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns list of nodes marked as hidden.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of hidden nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hidden_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns list of nodes marked as hidden.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: of hidden nodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">node</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">hidden</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">HIDDEN</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">hidden</span> <span class="ow">is</span> <span class="kc">True</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.intervene_on" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">intervene_on</span><span class="p">(</span><span class="n">nodes_values</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Specify hard or soft intervention.</p>
<p>If you want to intervene
upon more than one node provide a list of nodes to intervene on
and a list of corresponding values to set these nodes to.
(see example). The mutilated dag will automatically be
stored in <code>mutiliated_dags</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes_values</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="sympy.stats.rv.RandomSymbol">RandomSymbol</span> | <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>either single real
number or sympy.stats.RandomSymbol. If you like to intervene on
more than one node, just provide more key-value pairs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If node(s) are not in the graph</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">intervene_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RandomSymbol</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specify hard or soft intervention.</span>

<span class="sd">    If you want to intervene</span>
<span class="sd">    upon more than one node provide a list of nodes to intervene on</span>
<span class="sd">    and a list of corresponding values to set these nodes to.</span>
<span class="sd">    (see example). The mutilated dag will automatically be</span>
<span class="sd">    stored in `mutiliated_dags`.</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes_values (dict[str, RandomSymbol | float]): either single real</span>
<span class="sd">            number or sympy.stats.RandomSymbol. If you like to intervene on</span>
<span class="sd">            more than one node, just provide more key-value pairs.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If node(s) are not in the graph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;You need to train a drf first.&quot;</span><span class="p">)</span>
    <span class="n">drf_replace</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
            <span class="s2">&quot;One or more nodes you want to intervene upon are not in the graph.&quot;</span>
        <span class="p">)</span>

    <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">nodes_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">old_incoming</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
        <span class="n">edges_to_remove</span> <span class="o">=</span> <span class="p">[(</span><span class="n">old</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">old</span> <span class="ow">in</span> <span class="n">old_incoming</span><span class="p">]</span>
        <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">edges_to_remove</span><span class="p">)</span>
        <span class="n">drf_replace</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">mutilated_dag</span>  <span class="c1"># specifiying the same set twice will override</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">interventional_drf</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">drf_replace</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.interventional_amat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interventional_amat</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the adjacency matrix of a chosen mutilated DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>which_intervention</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integer count of your chosen intervention or
literal string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"The intervention you provide does not exist."</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Adjacency matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interventional_amat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the adjacency matrix of a chosen mutilated DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        which_intervention (int | str): Integer count of your chosen intervention or</span>
<span class="sd">            literal string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: &quot;The intervention you provide does not exist.&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Adjacency matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you provide does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you index does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

    <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">mutilated_dag</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.load_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_drf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Loads a drf dict from a .pkl file into the workspace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the file e.g. examplefile.pkl</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to file in case it's not located
in the current working directory. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DRF</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict of trained drf objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_drf</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a drf dict from a .pkl file into the workspace.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): name of the file e.g. examplefile.pkl</span>
<span class="sd">        location (str, optional): path to file in case it&#39;s not located</span>
<span class="sd">            in the current working directory. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DRF (dict): dict of trained drf objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">drf</span><span class="p">:</span>
        <span class="n">pickle_drf</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">drf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pickle_drf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.load_pline_from_pickle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_pline_from_pickle</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Load production line graph from a pickle file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_pline_from_pickle</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load production line graph from a pickle file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): _description_</span>
<span class="sd">        location (str | Path | None, optional): _description_. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pline</span><span class="p">:</span>
        <span class="n">pickle_line</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pline</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pickle_line</span><span class="p">,</span> <span class="n">ProductionLineGraph</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You didn&#39;t refer to a ProductionLineGraph.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pickle_line</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.new_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new_cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_eol</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a new cell to the production line.</p>
<p>If no name is given, cell name is given by counting available cells + 1</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_eol</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether cell is end-of-line. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ProcessCell (causalAssembly.models_dag.ProcessCell)" href="#causalAssembly.models_dag.ProcessCell">ProcessCell</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ProcessCell</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">new_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_eol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ProcessCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a new cell to the production line.</span>

<span class="sd">    If no name is given, cell name is given by counting available cells + 1</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str, optional): Defaults to None.</span>
<span class="sd">        is_eol (bool, optional): Whether cell is end-of-line. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ProcessCell</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ProcessCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">actual_no_of_cells</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">ProcessCell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_prefix</span><span class="si">}{</span><span class="n">actual_no_of_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">c</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>  <span class="c1"># type: ignore</span>

    <span class="n">c</span><span class="o">.</span><span class="n">is_eol</span> <span class="o">=</span> <span class="n">is_eol</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__add_cell</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.parents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return parents of node in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>of_node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node in question.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: parent set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        of_node (str): Node in question.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: parent set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.sample_from_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_from_drf</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Draw from the trained DRF.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be drawn. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smoothed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to true, marginal distributions will
be sampled from smoothed bootstraps. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">        smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">            be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.sample_from_interventional_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_from_interventional_drf</span><span class="p">(</span><span class="n">which_intervention</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Draw from the trained and intervened upon DRF.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be drawn. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>which_intervention</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which intervention to choose from.
Both the literal name (see the property <code>interventions</code>) and the index
are possible. Defaults to the first intervention.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smoothed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to true, marginal distributions will
be sampled from smoothed bootstraps. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame that follows the interventional distribution
implied by the ground truth.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_from_interventional_drf</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw from the trained and intervened upon DRF.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">        which_intervention (str | int): Which intervention to choose from.</span>
<span class="sd">            Both the literal name (see the property `interventions`) and the index</span>
<span class="sd">            are possible. Defaults to the first intervention.</span>
<span class="sd">        smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">            be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame that follows the interventional distribution</span>
<span class="sd">            implied by the ground truth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_interventional_sample_from_drf</span><span class="p">(</span>
        <span class="n">prod_object</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="o">=</span><span class="n">which_intervention</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.save_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_drf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes a drf dict to file. Please provide the .pkl suffix!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the file to be written e.g. examplefile.pkl</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to file in case it's not located in
the current working directory. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">        location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">            the current working directory. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="n">meta_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot full assembly line.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>meta_description</code>
            </td>
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specify additional cell info.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig_size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adjust depending on number of cells.
Defaults to (15, 8).</p>
              </div>
            </td>
            <td>
                  <code>(15, 8)</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Meta list entry needs to exist for each cell!</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta_description</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot full assembly line.</span>

<span class="sd">    Args:</span>
<span class="sd">        meta_description (list | None, optional): Specify additional cell info.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        fig_size (tuple, optional): Adjust depending on number of cells.</span>
<span class="sd">            Defaults to (15, 8).</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: Meta list entry needs to exist for each cell!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">meta_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">meta_description</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">))]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_description</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Meta list entry needs to exist for each cell!&quot;</span><span class="p">)</span>

    <span class="n">max_in_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()])</span>
    <span class="n">max_out_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()])</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">station_name</span><span class="p">,</span> <span class="n">meta_desc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_order</span><span class="p">,</span> <span class="n">meta_description</span><span class="p">)):</span>
        <span class="n">pos</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span><span class="o">.</span><span class="n">_plot_cellgraph</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">with_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">with_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">meta_desc</span><span class="o">=</span><span class="n">meta_desc</span><span class="p">,</span>
                <span class="n">center</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                <span class="n">node_color</span><span class="o">=</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_in_degree</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nodes_of_station</span><span class="p">(</span><span class="n">station_name</span><span class="p">))</span>
                <span class="p">],</span>
                <span class="n">node_size</span><span class="o">=</span><span class="p">[</span>
                    <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_out_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nodes_of_station</span><span class="p">(</span><span class="n">station_name</span><span class="p">))</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.to_cpdag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_cpdag</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert to CPDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to CPDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.via_cell_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">via_cell_number</span><span class="p">(</span><span class="n">n_cells</span><span class="p">,</span> <span class="n">cell_prefix</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Inits a ProductionLineGraph with predefined number of cells, e.g. n_cells = 3.</p>
<p>Will create empty  C0, C1 and C2 as cells if no other cell_prefix is given.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_cells</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cells the graph will have</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you like other cell names pass them here.
Defaults to "C".</p>
              </div>
            </td>
            <td>
                  <code>&#39;C&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">via_cell_number</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">n_cells</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cell_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits a ProductionLineGraph with predefined number of cells, e.g. n_cells = 3.</span>

<span class="sd">    Will create empty  C0, C1 and C2 as cells if no other cell_prefix is given.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_cells (int): Number of cells the graph will have</span>
<span class="sd">        cell_prefix (str, optional): If you like other cell names pass them here.</span>
<span class="sd">            Defaults to &quot;C&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">cell_prefix</span> <span class="o">=</span> <span class="n">cell_prefix</span>

    <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">new_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">pl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_dag.ProductionLineGraph.visible_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visible_nodes</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>All visible nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visible_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;All visible nodes in the graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_nodes</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="causalAssembly.models_dag.choose_edges_from_cells_randomly" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">choose_edges_from_cells_randomly</span><span class="p">(</span><span class="n">from_cell</span><span class="p">,</span> <span class="n">to_cell</span><span class="p">,</span> <span class="n">probability</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Choose cells randomly.</p>
<p>From two given cells (graphs), we take the cartesian product (end up with
from_cell.number_of_nodes x to_cell.number_of_nodes possible edges (node tuples).</p>
<p>From this product we draw probability x cartesian product number of edges randomly.</p>
<p>In case we have a float number, we ceil the value,
e.g. 17.3 edges will lead to 18 edges drawn.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_cell</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ProcessCell (causalAssembly.models_dag.ProcessCell)" href="#causalAssembly.models_dag.ProcessCell">ProcessCell</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ProcessCell from where we want the edges</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_cell</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ProcessCell (causalAssembly.models_dag.ProcessCell)" href="#causalAssembly.models_dag.ProcessCell">ProcessCell</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ProcessCell to where we want the edges</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probability</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>between 0 and 1</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rng</code>
            </td>
            <td>
                  <code><span title="numpy.random.Generator">Generator</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random number generator to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple[str, str]]: Chosen edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">choose_edges_from_cells_randomly</span><span class="p">(</span>
    <span class="n">from_cell</span><span class="p">:</span> <span class="n">ProcessCell</span><span class="p">,</span>
    <span class="n">to_cell</span><span class="p">:</span> <span class="n">ProcessCell</span><span class="p">,</span>
    <span class="n">probability</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">rng</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Choose cells randomly.</span>

<span class="sd">    From two given cells (graphs), we take the cartesian product (end up with</span>
<span class="sd">    from_cell.number_of_nodes x to_cell.number_of_nodes possible edges (node tuples).</span>

<span class="sd">    From this product we draw probability x cartesian product number of edges randomly.</span>

<span class="sd">    In case we have a float number, we ceil the value,</span>
<span class="sd">    e.g. 17.3 edges will lead to 18 edges drawn.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_cell: ProcessCell from where we want the edges</span>
<span class="sd">        to_cell: ProcessCell to where we want the edges</span>
<span class="sd">        probability: between 0 and 1</span>
<span class="sd">        rng (np.random.Generator): Random number generator to use.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[tuple[str, str]]: Chosen edges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ONE</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">probability</span> <span class="o">&lt;=</span> <span class="n">ONE</span>

    <span class="n">arrow_tail_candidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">from_cell</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">arrow_head_candidates</span> <span class="o">=</span> <span class="n">get_arrow_head_candidates_from_graph</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">to_cell</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

    <span class="n">potential_edges</span> <span class="o">=</span> <span class="n">tuples_from_cartesian_product</span><span class="p">(</span>
        <span class="n">l1</span><span class="o">=</span><span class="n">arrow_tail_candidates</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="n">arrow_head_candidates</span>
    <span class="p">)</span>

    <span class="n">num_to_choose</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">probability</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">)))</span>

    <span class="n">chosen_edges</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">potential_edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">potential_edges</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">num_to_choose</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">chosen_edges</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.models_dag.get_arrow_head_candidates_from_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_arrow_head_candidates_from_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="o">=</span><span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns all arrow head (nodes where an arrow points to) nodes as list of candidates.</p>
<p>To later build a list of tuples of potential edges.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_attributes_to_filter</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>see NodeAttributes.
Defaults to NodeAttributes.ALLOW_IN_EDGES.</p>
              </div>
            </td>
            <td>
                  <code><span title="causalAssembly.models_dag.NodeAttributes.ALLOW_IN_EDGES">ALLOW_IN_EDGES</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: list of nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_arrow_head_candidates_from_graph</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">NodeAttributes</span><span class="o">.</span><span class="n">ALLOW_IN_EDGES</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all arrow head (nodes where an arrow points to) nodes as list of candidates.</span>

<span class="sd">    To later build a list of tuples of potential edges.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph (nx.DiGraph): DAG</span>
<span class="sd">        node_attributes_to_filter (str, optional): see NodeAttributes.</span>
<span class="sd">            Defaults to NodeAttributes.ALLOW_IN_EDGES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: list of nodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arrow_head_candidates</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">node</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">allowed</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="kc">True</span>
    <span class="p">]</span>

    <span class="n">nodes_without_attributes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_attributes_to_filter</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arrow_head_candidates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes_without_attributes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;None of the nodes in cell </span><span class="si">{</span><span class="n">graph</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">            are allowed to have in-edges.&quot;</span>
        <span class="p">)</span>

    <span class="n">arrow_head_candidates</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nodes_without_attributes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">arrow_head_candidates</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.dag_utils"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="causalAssembly.dag_utils.merge_dags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_dags</span><span class="p">(</span><span class="n">dag_to_insert</span><span class="p">,</span> <span class="n">target_dag</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">remove_in_edges_in_target_dag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Dag_to_insert will be connected to target_tag via mapping dict.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dag_to_insert</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG to insert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG on which to map.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping from insert to target dag e.g.
{C1: D1, C5: D4} where node C1 from insert dag will
be mapped to node D1 of target dag.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_in_edges_in_target_dag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node does not exist in target_dag</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node does not exist in dag_to_insert</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    nx.DiGraph: merged DAG</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_dags</span><span class="p">(</span>
    <span class="n">dag_to_insert</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="n">target_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">remove_in_edges_in_target_dag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dag_to_insert will be connected to target_tag via mapping dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        dag_to_insert (nx.DiGraph): DAG to insert.</span>
<span class="sd">        target_dag (nx.DiGraph): DAG on which to map.</span>
<span class="sd">        mapping (dict): Mapping from insert to target dag e.g.</span>
<span class="sd">            {C1: D1, C5: D4} where node C1 from insert dag will</span>
<span class="sd">            be mapped to node D1 of target dag.</span>
<span class="sd">        remove_in_edges_in_target_dag (bool, optional): Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: node does not exist in target_dag</span>
<span class="sd">        ValueError: node does not exist in dag_to_insert</span>
<span class="sd">    Returns:</span>
<span class="sd">        nx.DiGraph: merged DAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">old_node_name</span><span class="p">,</span> <span class="n">new_node_name</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">new_node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">new_node_name</span><span class="si">}</span><span class="s2"> does not exist in target_dag&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">old_node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dag_to_insert</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">old_node_name</span><span class="si">}</span><span class="s2"> does not exist in dag_to_insert&quot;</span><span class="p">)</span>

    <span class="n">no_of_nodes_insert_dag</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dag_to_insert</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">no_of_nodes_target_dag</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">no_of_nodes_insert_dag</span> <span class="o">&gt;</span> <span class="n">no_of_nodes_target_dag</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;you are trying to merge a DAG of size=</span><span class="si">{</span><span class="n">no_of_nodes_insert_dag</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;into a smaller DAG of size=</span><span class="si">{</span><span class="n">no_of_nodes_target_dag</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;If this is not intentional consider changing the order&quot;</span>
        <span class="p">)</span>

    <span class="c1"># remove all in edges on target node</span>
    <span class="k">if</span> <span class="n">remove_in_edges_in_target_dag</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">target_dag</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">target_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c1"># rename nodes to glue together</span>
    <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">dag_to_insert</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">dag</span><span class="p">,</span> <span class="n">target_dag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.dag_utils.merge_dags_via_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_dags_via_edges</span><span class="p">(</span><span class="n">left_dag</span><span class="p">,</span> <span class="n">right_dag</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">isolate_target_nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Merges two dags via a list of edges.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>left_dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dag to merge to right_dag</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>right_dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dag to merge left_dag into</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of edges that connect the two dags.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>isolate_target_nodes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool if True all incoming edges
from the right_dag into the target node are removed:
all influence from the left_dag, defined via edges list.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>source or target nodes are not available in left dag</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>source or target nodes are not available in right dag</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_dags_via_edges</span><span class="p">(</span>
    <span class="n">left_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="n">right_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">isolate_target_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merges two dags via a list of edges.</span>

<span class="sd">    Args:</span>
<span class="sd">        left_dag (nx.DiGraph): dag to merge to right_dag</span>
<span class="sd">        right_dag (nx.DiGraph):  dag to merge left_dag into</span>
<span class="sd">        edges (list[tuple], optional): list of edges that connect the two dags.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        isolate_target_nodes (bool, optional): bool if True all incoming edges</span>
<span class="sd">            from the right_dag into the target node are removed:</span>
<span class="sd">            all influence from the left_dag, defined via edges list.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: source or target nodes are not available in left dag</span>
<span class="sd">        ValueError: source or target nodes are not available in right dag</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">source_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>
    <span class="n">target_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">left_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;At least one of the source nodes: </span><span class="si">{</span><span class="n">source_nodes</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;cannot be found in the left DAGs nodes: </span><span class="si">{</span><span class="n">left_dag</span><span class="o">.</span><span class="n">nodes</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_nodes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">right_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;At least one of the target nodes: </span><span class="si">{</span><span class="n">target_nodes</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;cannot be found in right DAGs nodes: </span><span class="si">{</span><span class="n">right_dag</span><span class="o">.</span><span class="n">nodes</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">isolate_target_nodes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">target_nodes</span><span class="p">:</span>
            <span class="c1"># cast to list to work with value not with reference</span>
            <span class="n">edges_to_target_node</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">right_dag</span><span class="o">.</span><span class="n">in_edges</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
            <span class="n">right_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">edges_to_target_node</span><span class="p">)</span>

    <span class="n">merged_dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">left_dag</span><span class="p">,</span> <span class="n">right_dag</span><span class="p">)</span>

    <span class="n">merged_dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;connector&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">merged_dag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.dag_utils.tuples_from_cartesian_product" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tuples_from_cartesian_product</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Given two lists l1 and l2 this creates the cartesian product and returns all tuples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>l1</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First list of nodes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>l2</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second list of nodes typically</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]: list of edges typically</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples::</p>
<pre><code>l1 = [0,1,2]
l2 = ['a','b','c']
&gt;&gt;&gt; tuples_from_cartesian_product(l1,l2)
[(0,'a'), (0,'b'), (0,'c'), (1,'a'), (1,'b'), (1,'c'), (2,'a'), (2,'b'), (2,'c')]
</code></pre>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tuples_from_cartesian_product</span><span class="p">(</span><span class="n">l1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">l2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given two lists l1 and l2 this creates the cartesian product and returns all tuples.</span>

<span class="sd">    Args:</span>
<span class="sd">        l1 (list): First list of nodes</span>
<span class="sd">        l2 (list): Second list of nodes typically</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[tuple]: list of edges typically</span>

<span class="sd">    Examples::</span>

<span class="sd">        l1 = [0,1,2]</span>
<span class="sd">        l2 = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]</span>
<span class="sd">        &gt;&gt;&gt; tuples_from_cartesian_product(l1,l2)</span>
<span class="sd">        [(0,&#39;a&#39;), (0,&#39;b&#39;), (0,&#39;c&#39;), (1,&#39;a&#39;), (1,&#39;b&#39;), (1,&#39;c&#39;), (2,&#39;a&#39;), (2,&#39;b&#39;), (2,&#39;c&#39;)]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
            <span class="n">l1</span><span class="p">,</span>
            <span class="n">l2</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.models_fcm"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.models_fcm.FCM" class="doc doc-heading">
            <code>FCM</code>


</h2>


    <div class="doc doc-contents ">


        <p>Class to define, intervene and sample from an FCM.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <pre><code class="language-python">from sympy import symbols
from sympy.stats import Normal, Uniform, Gamma

x, y, z = symbols('x,y,z')

eq_x = Eq(x, Uniform(&quot;noise&quot;, left=-1, right=1))
eq_y = Eq(y, 2 * x ** 2 + Normal(&quot;error&quot;, 0, .5))
eq_z = Eq(z, 9 * y * x * Gamma(&quot;some_name&quot;, .5, .5))

eq_list = [eq_x, eq_y, eq_z]


self = FCM(name='test', seed=2023)
self.input_fcm(eq_list)
self.draw(size=10)
</code></pre>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FCM</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to define, intervene and sample from an FCM.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        from sympy import symbols</span>
<span class="sd">        from sympy.stats import Normal, Uniform, Gamma</span>

<span class="sd">        x, y, z = symbols(&#39;x,y,z&#39;)</span>

<span class="sd">        eq_x = Eq(x, Uniform(&quot;noise&quot;, left=-1, right=1))</span>
<span class="sd">        eq_y = Eq(y, 2 * x ** 2 + Normal(&quot;error&quot;, 0, .5))</span>
<span class="sd">        eq_z = Eq(z, 9 * y * x * Gamma(&quot;some_name&quot;, .5, .5))</span>

<span class="sd">        eq_list = [eq_x, eq_y, eq_z]</span>


<span class="sd">        self = FCM(name=&#39;test&#39;, seed=2023)</span>
<span class="sd">        self.input_fcm(eq_list)</span>
<span class="sd">        self.draw(size=10)</span>
<span class="sd">        ```</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2023</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits the FCM class.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str | None, optional): Name. Defaults to None.</span>
<span class="sd">            seed (int, optional): Seed. Defaults to 2023.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_dag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_mutilated_dag</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_mutilated_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">source_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns source nodes in the current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of source nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">causal_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the current graph.</span>

<span class="sd">        Note that this order is in general not unique. To</span>
<span class="sd">        ensure uniqueness, we additionally sort lexicograpically.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Symbol]: Causal order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of nodes in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of edges in the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sparsity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sparsity of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: in [0,1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_edges</span> <span class="o">/</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ground_truth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the current ground truth as pandas adjacency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Adjacenccy matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interventions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all interventions performed on the original graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of intervened upon nodes in do(x) notation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interventional_amat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the adjacency matrix of a chosen mutilated DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            which_intervention (int | str): Integer count of your chosen intervention or</span>
<span class="sd">                literal string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: &quot;The intervention you provide does not exist.&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Adjacency matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you provide does not exist.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you index does not exist.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

        <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">mutilated_dag</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            of_node (str): Node in question.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: parent set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return parents of node in question for a chosen DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (Symbol): node whose parents to return.</span>
<span class="sd">            which_graph (nx.DiGraph): which graph along the interventions.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Symbol]: list of parents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">causal_order_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the chosen graph.</span>

<span class="sd">        Note that this order is in general not unique. To</span>
<span class="sd">        ensure uniqueness, we additionally sort lexicograpically.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Symbol]: Causal order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="n">which_graph</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">source_nodes_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the source nodes of a chosen graph.</span>

<span class="sd">        This is mainly for</span>
<span class="sd">        choosing different mutilated DAGs.</span>

<span class="sd">        Args:</span>
<span class="sd">            which_graph (nx.DiGraph): DAG from which source nodes should be returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">node</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parents_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">input_fcm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Eq</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Automatically builds up DAG according to the FCM fed in.</span>

<span class="sd">        Args:</span>
<span class="sd">            fcm (list): list of sympy equations generated as:</span>
<span class="sd">                    ```[python]</span>
<span class="sd">                    x,y = symbols(&#39;x,y&#39;)</span>
<span class="sd">                    term_x = Eq(x, Normal(&#39;x&#39;, 0,1))</span>
<span class="sd">                    term_y = Eq(y, 2*x**2*Normal(&#39;noise&#39;, 0,1))</span>
<span class="sd">                    fcm = [term_x, term_y]</span>
<span class="sd">                    ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes_implied</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">free_symbols</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">]</span>
        <span class="n">edges_implied</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">RandomSymbol</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">):</span>
                    <span class="n">edges_implied</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">free_symbols</span>
                            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges_implied</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">atom</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)])</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes_implied</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges_implied</span><span class="p">)</span>

        <span class="n">term_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">:</span>
            <span class="n">term_dict</span><span class="p">[</span><span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="p">}</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">term_dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">function_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns functional assignment for node in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (Symbol): node corresponding to lhs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: key is node and value rhs of functional assignment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                    <span class="s2">&quot;You probably defined a string. Node has to be a symbol, check out&quot;</span><span class="p">,</span>
                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Node has to be in the graph&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">display_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays all functional assignments inputted into the FCM.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dict with keys equal to nodes and values equal to</span>
<span class="sd">                functional assignments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fcm_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_order</span><span class="p">:</span>
            <span class="n">fcm_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">fcm_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">additive_gaussian_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">snr</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">source_df</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sample from joint.</span>

<span class="sd">        Draw samples from the joint distribution that factorizes</span>
<span class="sd">        according to the DAG implied by the FCM fed in.</span>

<span class="sd">        To avoid unexpected/unintended behavior, avoid defining fully</span>
<span class="sd">        deterministic equation systems.</span>
<span class="sd">        If parameters in noise terms are additive and left unevaluated,</span>
<span class="sd">        they&#39;re set according to a chosen Signal-To-Noise (SNR) ratio.</span>
<span class="sd">        For convenience, you can add additive Gaussian noise to each equation.</span>
<span class="sd">        This will never overwrite any of the chosen noise distributions.</span>
<span class="sd">        You may also feed in a data frame for noise distributions (see below</span>
<span class="sd">        for more details).</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int): Number of samples to draw.</span>
<span class="sd">            additive_gaussian_noise (bool, optional): This will attach additive</span>
<span class="sd">                Gaussian noise to all terms without a RandomSymbol that are not</span>
<span class="sd">                source nodes. It acts merely as a convenience option. Variance</span>
<span class="sd">                will then be chosen according to SNR. Defaults to False.</span>
<span class="sd">            snr (None | float, optional): Signal-to-noise ratio</span>
<span class="sd">                \\( SNR =  \\frac{\\text{Var}(\\hat{X})}{\\hat\\sigma^2}. \\).</span>
<span class="sd">                Defaults to 1/2.</span>
<span class="sd">            source_df (None | pd.DataFrame, optional): Data frame containing source node data.</span>
<span class="sd">                The sample size must be at least as large as the number of samples</span>
<span class="sd">                you&#39;d like to draw. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: if source node parameters are not given explicitly.</span>
<span class="sd">            ValueError: if source node sample size is too small.</span>
<span class="sd">            ValueError: if scale parameters are left unevaluated for non-additive terms.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame:  Data frame with rows of length `size` and columns equal to the</span>
<span class="sd">                number of nodes in the graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="n">additive_gaussian_noise</span><span class="p">,</span>
            <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">,</span>
            <span class="n">source_df</span><span class="o">=</span><span class="n">source_df</span><span class="p">,</span>
            <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">interventional_sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">additive_gaussian_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">snr</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">source_df</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Draw samples from the interventional distribution.</span>

<span class="sd">        that factorizes according to the mutilated DAG after performing one or multiple</span>
<span class="sd">        interventions. Otherwise the method behaves similar to sampling from the</span>
<span class="sd">        non-interventional joint distribution. By default samples are drawn from the</span>
<span class="sd">        first intervention you performed. If you intervened upon more than one node,</span>
<span class="sd">        you&#39;ll have swith to another intervention for sampling from the corresponding</span>
<span class="sd">        interventional distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int): Number of samples to draw.</span>
<span class="sd">            which_intervention (str | int): Which interventional distribution to draw</span>
<span class="sd">                from. We recommend using integer counts starting from zero. But you can</span>
<span class="sd">                also provide the literal string here, e.g. if you intervened on say two</span>
<span class="sd">                nodes `x,y` then you would need to provide here: `do([x, y])`.</span>
<span class="sd">            additive_gaussian_noise (bool, optional): This will attach additive Gaussian noise</span>
<span class="sd">                to all terms without a RandomSymbol that are not source nodes. It acts merely as</span>
<span class="sd">                a convenience option. Variance will then be chosen according to SNR.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            snr (None | float, optional): Signal-to-noise ratio</span>
<span class="sd">                \\( SNR =  \\frac{\\text{Var}(\\hat{X})}{\\hat\\sigma^2}. \\). Defaults to 1/2.</span>
<span class="sd">            source_df (None | pd.DataFrame, optional): Data frame containing source node data.</span>
<span class="sd">                The sample size must be at least as large as the number of samples</span>
<span class="sd">                you&#39;d like to draw. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: Raised when `which_intervention` is not of correct form.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame with rows of length `size` and columns equal to the</span>
<span class="sd">                number of nodes in the graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">int_choice</span> <span class="o">=</span> <span class="n">which_intervention</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">int_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;which_intervention has to be </span><span class="se">\</span>
<span class="s2">                the literal string or an integer </span><span class="se">\</span>
<span class="s2">                starting at count zero indicating </span><span class="se">\</span>
<span class="s2">                which intervention in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                to use.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="n">additive_gaussian_noise</span><span class="p">,</span>
            <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">,</span>
            <span class="n">source_df</span><span class="o">=</span><span class="n">source_df</span><span class="p">,</span>
            <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">int_choice</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span>
        <span class="n">additive_gaussian_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">snr</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">source_df</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Draw samples from the joint distribution.</span>

<span class="sd">        that factorizes</span>
<span class="sd">        according to the DAG implied by the FCM fed in. To avoid</span>
<span class="sd">        unexpected/unintended behavior, avoid defining fully</span>
<span class="sd">        deterministic equation systems.</span>
<span class="sd">        If parameters in noise terms are additive and left unevaluated,</span>
<span class="sd">        they&#39;re set according to a chosen Signal-To-Noise (SNR) ratio.</span>
<span class="sd">        For convenience, you can add additive Gaussian noise to each equation.</span>
<span class="sd">        This will never overwrite any of the chosen noise distributions.</span>
<span class="sd">        You may also feed in a data frame for noise distributions (see below</span>
<span class="sd">        for more details).</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int): Number of samples to draw.</span>
<span class="sd">            which_graph (nx.DiGraph): Which graph to sample from.</span>
<span class="sd">            additive_gaussian_noise (bool, optional): _description_. Defaults to False.</span>
<span class="sd">            snr (None | float, optional): Signal-to-noise ratio</span>
<span class="sd">                \\( SNR =  \\frac{\\text{Var}(\\hat{X})}{\\hat\\sigma^2}. \\).</span>
<span class="sd">                Defaults to 1/2.</span>
<span class="sd">            source_df (None | pd.DataFrame, optional): Data frame conaining source node data.</span>
<span class="sd">                The sample size must be at least as large as the number of samples</span>
<span class="sd">                you&#39;d like to draw. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: if source node parameters are not given explicitly.</span>
<span class="sd">            ValueError: if source node sample size is too small.</span>
<span class="sd">            ValueError: if scale parameters are left unevaluated for non-additive terms.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame:  Data frame with rows of lenght size and columns equal to the</span>
<span class="sd">                number of nodes in the graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">source_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__source_df_condition</span><span class="p">(</span><span class="n">source_df</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Names in source_df don&#39;t match nodenames in graph.&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_order_of</span><span class="p">(</span><span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">order</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_nodes_of</span><span class="p">(</span><span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">source_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="ow">in</span> <span class="n">source_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">source_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Sample size of source node data must be at least </span><span class="se">\</span>
<span class="s2">                            as large as the number of samples you&#39;d like to draw.&quot;</span>
                        <span class="p">)</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="n">source_df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                        <span class="n">n</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                        <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">,</span>
                        <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">],</span> <span class="n">RandomSymbol</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__distribution_parameters_explicit</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Source node parameters need to be given explicitly.&quot;</span><span class="p">)</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sympy_sample</span><span class="p">(</span>
                        <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">],</span>
                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">],</span> <span class="n">Number</span><span class="p">):</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">],</span> <span class="n">repeats</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                        <span class="s2">&quot;Source nodes need to have a fully parameterized distribution, </span><span class="se">\</span>
<span class="s2">                        or need to be drawn from an appropriate data frame, or fixed to </span><span class="se">\</span>
<span class="s2">                        a single real number.&quot;</span>
                    <span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">fcm_expr</span> <span class="o">=</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__distribution_parameters_explicit</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">):</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">())]</span> <span class="o">=</span> <span class="n">sympy_sample</span><span class="p">(</span>
                        <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">())]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

            <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__eval_expression</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="o">=</span><span class="n">fcm_expr</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__distribution_parameters_explicit</span><span class="p">(</span>
                <span class="n">order</span><span class="p">,</span> <span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fcm_expr</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Noise term in &quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;=&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot; not additive. Scale parameter selection via SNR </span><span class="se">\</span>
<span class="s2">                        makes sense only for additive noise.&quot;</span>
                    <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;I&#39;ll choose the noise scale in &quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot;=&quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="p">)</span>
                    <span class="o">+</span> <span class="s2">&quot; according to the given SNR.&quot;</span>
                <span class="p">)</span>
                <span class="n">noise_var</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">/</span> <span class="n">snr</span>  <span class="c1"># type: ignore</span>
                <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">+</span> <span class="n">sympy_sample</span><span class="p">(</span>
                    <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__unfree_symbol</span><span class="p">(</span><span class="n">fcm_expr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_var</span><span class="p">)),</span>  <span class="c1"># type: ignore</span>
                    <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">additive_gaussian_noise</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Noise already defined in &quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;=&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;. I won&#39;t override this.&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">noise</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;noise&quot;</span><span class="p">)</span>
                    <span class="n">noise_var</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">/</span> <span class="n">snr</span>  <span class="c1"># type: ignore</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">noise</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
                        <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_var</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">fcm_expr</span> <span class="o">=</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">noise</span>
                    <span class="n">df</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__eval_expression</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="o">=</span><span class="n">fcm_expr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_order</span><span class="p">]]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__unfree_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
        <span class="n">random_symbs</span> <span class="o">=</span> <span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">unfree</span>
            <span class="k">for</span> <span class="n">unfree</span> <span class="ow">in</span> <span class="n">random_symbs</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">unfree</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
        <span class="p">}</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__eval_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Eval given fcm_expression with the values in given dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): Data frame.</span>
<span class="sd">            fcm_expr (Expr): Sympy expression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame after eval.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">correct_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ordered</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">))</span>  <span class="c1"># self.__return_ordered_args(fcm_expr)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">correct_order</span><span class="p">]</span>
        <span class="n">evaluator</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">correct_order</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">,</span> <span class="s2">&quot;scipy&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">evaluator</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__distribution_parameters_explicit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns true if distribution parameters are given explicitly, not symbolically.</span>

<span class="sd">        Args:</span>
<span class="sd">            order (node): node in graph</span>
<span class="sd">            which_graph (nx.DiGraph): which graph to choose.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__source_df_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns true if source_df colnames and graph nodenames agree.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_df (None | pd.DataFrame): data frame containing source node data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if names agree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">source_df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span>
            <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_nodes</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">intervene_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Symbol</span><span class="p">,</span> <span class="n">RandomSymbol</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Specify hard or soft intervention.</span>

<span class="sd">        If you want to intervene</span>
<span class="sd">        upon more than one node provide a list of nodes to intervene on</span>
<span class="sd">        and a list of corresponding values to set these nodes to.</span>
<span class="sd">        (see example). The mutilated dag will automatically be</span>
<span class="sd">        stored in `mutiliated_dags`.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes_values (dict[Symbol, RandomSymbol | float]): either single real</span>
<span class="sd">                number or RandmSymbol. If you provide more than one</span>
<span class="sd">                intervention just provide more key-value pairs.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If node(s) are not in the graph</span>

<span class="sd">        Example:</span>
<span class="sd">            ```python</span>
<span class="sd">            x,y = symbols(&quot;x,y&quot;)</span>
<span class="sd">            eq_x = Eq(x, Gamma(&quot;source&quot;, 1,1))</span>
<span class="sd">            eq_y = Eq(y, 4*x**3 + Uniform(&quot;noise&quot;, left=-0.5, right=0.5))</span>

<span class="sd">            example_fcm = FCM()</span>
<span class="sd">            example_fcm.input_fcm([eq_x,eq_y])</span>
<span class="sd">            # Hard intervention</span>
<span class="sd">            example_fcm.intervene_on(nodes_values = {y : 4})</span>
<span class="sd">            # Soft intervention</span>
<span class="sd">            example_fcm.intervene_on(nodes_values = {y : Normal(&quot;noise&quot;,0,1)})</span>

<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;One or more nodes you want to intervene upon are not in the graph.&quot;</span>
            <span class="p">)</span>

        <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">nodes_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">intervention</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">old_incoming</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
            <span class="n">edges_to_remove</span> <span class="o">=</span> <span class="p">[(</span><span class="n">old</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">old</span> <span class="ow">in</span> <span class="n">old_incoming</span><span class="p">]</span>
            <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">edges_to_remove</span><span class="p">)</span>
            <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">intervention</span><span class="o">.</span><span class="n">rhs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">mutilated_dag</span>  <span class="c1"># specifiying the same set twice will override</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the current DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            header (str | None, optional): Header for the DAG. Defaults to None.</span>
<span class="sd">            with_nodenames (bool, optional): Whether or not to use nodenames as</span>
<span class="sd">                labels in the plot. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt: Plot of the DAG.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show</span><span class="p">(</span><span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="o">=</span><span class="n">with_nodenames</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_mutilated_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot mutilated DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            which_intervention (str | int, optional): Which interventional distribution</span>
<span class="sd">                should be represented by a DAG. Defaults to 0.</span>
<span class="sd">            with_nodenames (bool, optional): Whether or not to use nodenames as</span>
<span class="sd">                labels in the plot. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt: Plot of the mutilated DAG.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show</span><span class="p">(</span>
            <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">],</span>
            <span class="n">header</span><span class="o">=</span><span class="n">which_intervention</span><span class="p">,</span>
            <span class="n">with_nodenames</span><span class="o">=</span><span class="n">with_nodenames</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the graph by giving extra weight to nodes with high in- and out-degree.</span>

<span class="sd">        Args:</span>
<span class="sd">            which_graph (nx.DiGraph): _description_</span>
<span class="sd">            header (str): _description_</span>
<span class="sd">            with_nodenames (bool): _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">center</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span>
            <span class="n">which_graph</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>

        <span class="n">max_in_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()])</span>
        <span class="n">max_out_degree</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()])</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span>
            <span class="n">which_graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">node_color</span><span class="o">=</span><span class="p">[</span>
                <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_in_degree</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
            <span class="p">],</span>  <span class="c1"># type: ignore</span>
            <span class="n">node_size</span><span class="o">=</span><span class="p">[</span>
                <span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_out_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
            <span class="p">],</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">with_nodenames</span><span class="p">:</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span>
                <span class="n">which_graph</span><span class="p">,</span>
                <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                <span class="n">font_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span>
            <span class="n">which_graph</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">arrowsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=0.3&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.2</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.causal_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">causal_order</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the causal order of the current graph.</p>
<p>Note that this order is in general not unique. To
ensure uniqueness, we additionally sort lexicograpically.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.Symbol">Symbol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Symbol]: Causal order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.ground_truth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ground_truth</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the current ground truth as pandas adjacency.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Adjacenccy matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.interventions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interventions</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns all interventions performed on the original graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of intervened upon nodes in do(x) notation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.Symbol">Symbol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.num_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of edges in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.num_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of nodes in the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.source_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns source nodes in the current DAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of source nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.models_fcm.FCM.sparsity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sparsity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Sparsity of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in [0,1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.__distribution_parameters_explicit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__distribution_parameters_explicit</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns true if distribution parameters are given explicitly, not symbolically.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="node">node</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>which_graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>which graph to choose.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__distribution_parameters_explicit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns true if distribution parameters are given explicitly, not symbolically.</span>

<span class="sd">    Args:</span>
<span class="sd">        order (node): node in graph</span>
<span class="sd">        which_graph (nx.DiGraph): which graph to choose.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
        <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">order</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.__eval_expression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__eval_expression</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Eval given fcm_expression with the values in given dataframe.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fcm_expr</code>
            </td>
            <td>
                  <code><span title="sympy.Expr">Expr</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sympy expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame after eval.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__eval_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">:</span> <span class="n">Expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eval given fcm_expression with the values in given dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Data frame.</span>
<span class="sd">        fcm_expr (Expr): Sympy expression.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame after eval.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">correct_order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ordered</span><span class="p">(</span><span class="n">fcm_expr</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">))</span>  <span class="c1"># self.__return_ordered_args(fcm_expr)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">correct_order</span><span class="p">]</span>
    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">correct_order</span><span class="p">,</span> <span class="n">fcm_expr</span><span class="p">,</span> <span class="s2">&quot;scipy&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">evaluator</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Inits the FCM class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed. Defaults to 2023.</p>
              </div>
            </td>
            <td>
                  <code>2023</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2023</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits the FCM class.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str | None, optional): Name. Defaults to None.</span>
<span class="sd">        seed (int, optional): Seed. Defaults to 2023.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__init_dag</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__init_mutilated_dag</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.__source_df_condition" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__source_df_condition</span><span class="p">(</span><span class="n">source_df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns true if source_df colnames and graph nodenames agree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source_df</code>
            </td>
            <td>
                  <code>None | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data frame containing source node data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if names agree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__source_df_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns true if source_df colnames and graph nodenames agree.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_df (None | pd.DataFrame): data frame containing source node data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if names agree</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">source_df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span>
        <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_nodes</span><span class="p">}</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.causal_order_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">causal_order_of</span><span class="p">(</span><span class="n">which_graph</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the causal order of the chosen graph.</p>
<p>Note that this order is in general not unique. To
ensure uniqueness, we additionally sort lexicograpically.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.Symbol">Symbol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Symbol]: Causal order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">causal_order_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the chosen graph.</span>

<span class="sd">    Note that this order is in general not unique. To</span>
<span class="sd">    ensure uniqueness, we additionally sort lexicograpically.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Symbol]: Causal order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="n">which_graph</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.display_functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">display_functions</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Displays all functional assignments inputted into the FCM.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with keys equal to nodes and values equal to
functional assignments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">display_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays all functional assignments inputted into the FCM.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dict with keys equal to nodes and values equal to</span>
<span class="sd">            functional assignments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fcm_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_order</span><span class="p">:</span>
        <span class="n">fcm_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fcm_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.function_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">function_of</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns functional assignment for node in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="sympy.Symbol">Symbol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node corresponding to lhs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>key is node and value rhs of functional assignment.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">function_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns functional assignment for node in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (Symbol): node corresponding to lhs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: key is node and value rhs of functional assignment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;You probably defined a string. Node has to be a symbol, check out&quot;</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Node has to be in the graph&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.input_fcm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_fcm</span><span class="p">(</span><span class="n">fcm</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Automatically builds up DAG according to the FCM fed in.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fcm</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of sympy equations generated as:
    <code>[python]
    x,y = symbols('x,y')
    term_x = Eq(x, Normal('x', 0,1))
    term_y = Eq(y, 2*x**2*Normal('noise', 0,1))
    fcm = [term_x, term_y]</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">input_fcm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Eq</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically builds up DAG according to the FCM fed in.</span>

<span class="sd">    Args:</span>
<span class="sd">        fcm (list): list of sympy equations generated as:</span>
<span class="sd">                ```[python]</span>
<span class="sd">                x,y = symbols(&#39;x,y&#39;)</span>
<span class="sd">                term_x = Eq(x, Normal(&#39;x&#39;, 0,1))</span>
<span class="sd">                term_y = Eq(y, 2*x**2*Normal(&#39;noise&#39;, 0,1))</span>
<span class="sd">                fcm = [term_x, term_y]</span>
<span class="sd">                ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nodes_implied</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">free_symbols</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">]</span>
    <span class="n">edges_implied</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">RandomSymbol</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">):</span>
                <span class="n">edges_implied</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">free_symbols</span>
                        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">RandomSymbol</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">edges_implied</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">atom</span><span class="p">,</span> <span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)])</span>

    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes_implied</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges_implied</span><span class="p">)</span>

    <span class="n">term_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">fcm</span><span class="p">:</span>
        <span class="n">term_dict</span><span class="p">[</span><span class="n">term</span><span class="o">.</span><span class="n">lhs</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="n">term</span><span class="o">.</span><span class="n">rhs</span><span class="p">}</span>

    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">term_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.intervene_on" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">intervene_on</span><span class="p">(</span><span class="n">nodes_values</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Specify hard or soft intervention.</p>
<p>If you want to intervene
upon more than one node provide a list of nodes to intervene on
and a list of corresponding values to set these nodes to.
(see example). The mutilated dag will automatically be
stored in <code>mutiliated_dags</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes_values</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="sympy.Symbol">Symbol</span>, <span title="sympy.stats.rv.RandomSymbol">RandomSymbol</span> | <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>either single real
number or RandmSymbol. If you provide more than one
intervention just provide more key-value pairs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If node(s) are not in the graph</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">x,y = symbols(&quot;x,y&quot;)
eq_x = Eq(x, Gamma(&quot;source&quot;, 1,1))
eq_y = Eq(y, 4*x**3 + Uniform(&quot;noise&quot;, left=-0.5, right=0.5))

example_fcm = FCM()
example_fcm.input_fcm([eq_x,eq_y])
# Hard intervention
example_fcm.intervene_on(nodes_values = {y : 4})
# Soft intervention
example_fcm.intervene_on(nodes_values = {y : Normal(&quot;noise&quot;,0,1)})

</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">intervene_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Symbol</span><span class="p">,</span> <span class="n">RandomSymbol</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specify hard or soft intervention.</span>

<span class="sd">    If you want to intervene</span>
<span class="sd">    upon more than one node provide a list of nodes to intervene on</span>
<span class="sd">    and a list of corresponding values to set these nodes to.</span>
<span class="sd">    (see example). The mutilated dag will automatically be</span>
<span class="sd">    stored in `mutiliated_dags`.</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes_values (dict[Symbol, RandomSymbol | float]): either single real</span>
<span class="sd">            number or RandmSymbol. If you provide more than one</span>
<span class="sd">            intervention just provide more key-value pairs.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If node(s) are not in the graph</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        x,y = symbols(&quot;x,y&quot;)</span>
<span class="sd">        eq_x = Eq(x, Gamma(&quot;source&quot;, 1,1))</span>
<span class="sd">        eq_y = Eq(y, 4*x**3 + Uniform(&quot;noise&quot;, left=-0.5, right=0.5))</span>

<span class="sd">        example_fcm = FCM()</span>
<span class="sd">        example_fcm.input_fcm([eq_x,eq_y])</span>
<span class="sd">        # Hard intervention</span>
<span class="sd">        example_fcm.intervene_on(nodes_values = {y : 4})</span>
<span class="sd">        # Soft intervention</span>
<span class="sd">        example_fcm.intervene_on(nodes_values = {y : Normal(&quot;noise&quot;,0,1)})</span>

<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
            <span class="s2">&quot;One or more nodes you want to intervene upon are not in the graph.&quot;</span>
        <span class="p">)</span>

    <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">nodes_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">intervention</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">old_incoming</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
        <span class="n">edges_to_remove</span> <span class="o">=</span> <span class="p">[(</span><span class="n">old</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">old</span> <span class="ow">in</span> <span class="n">old_incoming</span><span class="p">]</span>
        <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">remove_edges_from</span><span class="p">(</span><span class="n">edges_to_remove</span><span class="p">)</span>
        <span class="n">mutilated_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;term&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">intervention</span><span class="o">.</span><span class="n">rhs</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;do(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">mutilated_dag</span>  <span class="c1"># specifiying the same set twice will override</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.interventional_amat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interventional_amat</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the adjacency matrix of a chosen mutilated DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>which_intervention</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integer count of your chosen intervention or
literal string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"The intervention you provide does not exist."</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Adjacency matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interventional_amat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the adjacency matrix of a chosen mutilated DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        which_intervention (int | str): Integer count of your chosen intervention or</span>
<span class="sd">            literal string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: &quot;The intervention you provide does not exist.&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Adjacency matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you provide does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">which_intervention</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The intervention you index does not exist.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

    <span class="n">mutilated_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">mutilated_dag</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.interventional_sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interventional_sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">which_intervention</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">source_df</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Draw samples from the interventional distribution.</p>
<p>that factorizes according to the mutilated DAG after performing one or multiple
interventions. Otherwise the method behaves similar to sampling from the
non-interventional joint distribution. By default samples are drawn from the
first intervention you performed. If you intervened upon more than one node,
you'll have swith to another intervention for sampling from the corresponding
interventional distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to draw.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>which_intervention</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which interventional distribution to draw
from. We recommend using integer counts starting from zero. But you can
also provide the literal string here, e.g. if you intervened on say two
nodes <code>x,y</code> then you would need to provide here: <code>do([x, y])</code>.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>additive_gaussian_noise</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This will attach additive Gaussian noise
to all terms without a RandomSymbol that are not source nodes. It acts merely as
a convenience option. Variance will then be chosen according to SNR.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snr</code>
            </td>
            <td>
                  <code>None | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal-to-noise ratio
\( SNR =  \frac{\text{Var}(\hat{X})}{\hat\sigma^2}. \). Defaults to 1/2.</p>
              </div>
            </td>
            <td>
                  <code>1 / 2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_df</code>
            </td>
            <td>
                  <code>None | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data frame containing source node data.
The sample size must be at least as large as the number of samples
you'd like to draw. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raised when <code>which_intervention</code> is not of correct form.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame with rows of length <code>size</code> and columns equal to the
number of nodes in the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interventional_sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">additive_gaussian_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">snr</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">source_df</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Draw samples from the interventional distribution.</span>

<span class="sd">    that factorizes according to the mutilated DAG after performing one or multiple</span>
<span class="sd">    interventions. Otherwise the method behaves similar to sampling from the</span>
<span class="sd">    non-interventional joint distribution. By default samples are drawn from the</span>
<span class="sd">    first intervention you performed. If you intervened upon more than one node,</span>
<span class="sd">    you&#39;ll have swith to another intervention for sampling from the corresponding</span>
<span class="sd">    interventional distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int): Number of samples to draw.</span>
<span class="sd">        which_intervention (str | int): Which interventional distribution to draw</span>
<span class="sd">            from. We recommend using integer counts starting from zero. But you can</span>
<span class="sd">            also provide the literal string here, e.g. if you intervened on say two</span>
<span class="sd">            nodes `x,y` then you would need to provide here: `do([x, y])`.</span>
<span class="sd">        additive_gaussian_noise (bool, optional): This will attach additive Gaussian noise</span>
<span class="sd">            to all terms without a RandomSymbol that are not source nodes. It acts merely as</span>
<span class="sd">            a convenience option. Variance will then be chosen according to SNR.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        snr (None | float, optional): Signal-to-noise ratio</span>
<span class="sd">            \\( SNR =  \\frac{\\text{Var}(\\hat{X})}{\\hat\\sigma^2}. \\). Defaults to 1/2.</span>
<span class="sd">        source_df (None | pd.DataFrame, optional): Data frame containing source node data.</span>
<span class="sd">            The sample size must be at least as large as the number of samples</span>
<span class="sd">            you&#39;d like to draw. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Raised when `which_intervention` is not of correct form.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame with rows of length `size` and columns equal to the</span>
<span class="sd">            number of nodes in the graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">int_choice</span> <span class="o">=</span> <span class="n">which_intervention</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">int_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;which_intervention has to be </span><span class="se">\</span>
<span class="s2">            the literal string or an integer </span><span class="se">\</span>
<span class="s2">            starting at count zero indicating </span><span class="se">\</span>
<span class="s2">            which intervention in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">            to use.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
        <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="n">additive_gaussian_noise</span><span class="p">,</span>
        <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">,</span>
        <span class="n">source_df</span><span class="o">=</span><span class="n">source_df</span><span class="p">,</span>
        <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">int_choice</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.parents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return parents of node in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>of_node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node in question.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.Symbol">Symbol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: parent set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parents of node in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        of_node (str): Node in question.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: parent set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">of_node</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.parents_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents_of</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return parents of node in question for a chosen DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="sympy.Symbol">Symbol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node whose parents to return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>which_graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>which graph along the interventions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.Symbol">Symbol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Symbol]: list of parents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Symbol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return parents of node in question for a chosen DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (Symbol): node whose parents to return.</span>
<span class="sd">        which_graph (nx.DiGraph): which graph along the interventions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Symbol]: list of parents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">which_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">source_df</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sample from joint.</p>
<p>Draw samples from the joint distribution that factorizes
according to the DAG implied by the FCM fed in.</p>
<p>To avoid unexpected/unintended behavior, avoid defining fully
deterministic equation systems.
If parameters in noise terms are additive and left unevaluated,
they're set according to a chosen Signal-To-Noise (SNR) ratio.
For convenience, you can add additive Gaussian noise to each equation.
This will never overwrite any of the chosen noise distributions.
You may also feed in a data frame for noise distributions (see below
for more details).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to draw.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>additive_gaussian_noise</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This will attach additive
Gaussian noise to all terms without a RandomSymbol that are not
source nodes. It acts merely as a convenience option. Variance
will then be chosen according to SNR. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snr</code>
            </td>
            <td>
                  <code>None | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal-to-noise ratio
\( SNR =  \frac{\text{Var}(\hat{X})}{\hat\sigma^2}. \).
Defaults to 1/2.</p>
              </div>
            </td>
            <td>
                  <code>1 / 2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_df</code>
            </td>
            <td>
                  <code>None | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data frame containing source node data.
The sample size must be at least as large as the number of samples
you'd like to draw. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if source node parameters are not given explicitly.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if source node sample size is too small.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if scale parameters are left unevaluated for non-additive terms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame:  Data frame with rows of length <code>size</code> and columns equal to the
number of nodes in the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">additive_gaussian_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">snr</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">source_df</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sample from joint.</span>

<span class="sd">    Draw samples from the joint distribution that factorizes</span>
<span class="sd">    according to the DAG implied by the FCM fed in.</span>

<span class="sd">    To avoid unexpected/unintended behavior, avoid defining fully</span>
<span class="sd">    deterministic equation systems.</span>
<span class="sd">    If parameters in noise terms are additive and left unevaluated,</span>
<span class="sd">    they&#39;re set according to a chosen Signal-To-Noise (SNR) ratio.</span>
<span class="sd">    For convenience, you can add additive Gaussian noise to each equation.</span>
<span class="sd">    This will never overwrite any of the chosen noise distributions.</span>
<span class="sd">    You may also feed in a data frame for noise distributions (see below</span>
<span class="sd">    for more details).</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int): Number of samples to draw.</span>
<span class="sd">        additive_gaussian_noise (bool, optional): This will attach additive</span>
<span class="sd">            Gaussian noise to all terms without a RandomSymbol that are not</span>
<span class="sd">            source nodes. It acts merely as a convenience option. Variance</span>
<span class="sd">            will then be chosen according to SNR. Defaults to False.</span>
<span class="sd">        snr (None | float, optional): Signal-to-noise ratio</span>
<span class="sd">            \\( SNR =  \\frac{\\text{Var}(\\hat{X})}{\\hat\\sigma^2}. \\).</span>
<span class="sd">            Defaults to 1/2.</span>
<span class="sd">        source_df (None | pd.DataFrame, optional): Data frame containing source node data.</span>
<span class="sd">            The sample size must be at least as large as the number of samples</span>
<span class="sd">            you&#39;d like to draw. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: if source node parameters are not given explicitly.</span>
<span class="sd">        ValueError: if source node sample size is too small.</span>
<span class="sd">        ValueError: if scale parameters are left unevaluated for non-additive terms.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame:  Data frame with rows of length `size` and columns equal to the</span>
<span class="sd">            number of nodes in the graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
        <span class="n">additive_gaussian_noise</span><span class="o">=</span><span class="n">additive_gaussian_noise</span><span class="p">,</span>
        <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">,</span>
        <span class="n">source_df</span><span class="o">=</span><span class="n">source_df</span><span class="p">,</span>
        <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the current DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>header</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Header for the DAG. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_nodenames</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to use nodenames as
labels in the plot. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>plt</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot of the DAG.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the current DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        header (str | None, optional): Header for the DAG. Defaults to None.</span>
<span class="sd">        with_nodenames (bool, optional): Whether or not to use nodenames as</span>
<span class="sd">            labels in the plot. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt: Plot of the DAG.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show</span><span class="p">(</span><span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="o">=</span><span class="n">with_nodenames</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.show_mutilated_dag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_mutilated_dag</span><span class="p">(</span><span class="n">which_intervention</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot mutilated DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>which_intervention</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which interventional distribution
should be represented by a DAG. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_nodenames</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to use nodenames as
labels in the plot. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>plt</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot of the mutilated DAG.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show_mutilated_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">with_nodenames</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot mutilated DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        which_intervention (str | int, optional): Which interventional distribution</span>
<span class="sd">            should be represented by a DAG. Defaults to 0.</span>
<span class="sd">        with_nodenames (bool, optional): Whether or not to use nodenames as</span>
<span class="sd">            labels in the plot. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt: Plot of the mutilated DAG.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">which_intervention</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">which_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interventions</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show</span><span class="p">(</span>
        <span class="n">which_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutilated_dags</span><span class="p">[</span><span class="n">which_intervention</span><span class="p">],</span>
        <span class="n">header</span><span class="o">=</span><span class="n">which_intervention</span><span class="p">,</span>
        <span class="n">with_nodenames</span><span class="o">=</span><span class="n">with_nodenames</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.models_fcm.FCM.source_nodes_of" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">source_nodes_of</span><span class="p">(</span><span class="n">which_graph</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the source nodes of a chosen graph.</p>
<p>This is mainly for
choosing different mutilated DAGs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>which_graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG from which source nodes should be returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/models_fcm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">source_nodes_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the source nodes of a chosen graph.</span>

<span class="sd">    This is mainly for</span>
<span class="sd">    choosing different mutilated DAGs.</span>

<span class="sd">    Args:</span>
<span class="sd">        which_graph (nx.DiGraph): DAG from which source nodes should be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of nodes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">node</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">which_graph</span><span class="o">.</span><span class="n">nodes</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parents_of</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">which_graph</span><span class="o">=</span><span class="n">which_graph</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.metrics"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.metrics.DAGmetrics" class="doc doc-heading">
            <code>DAGmetrics</code>


</h2>


    <div class="doc doc-contents ">


        <p>Class to calculate performance metrics for DAGs.</p>
<p>Make sure that the ground truth and the estimated DAG have the same order of
rows/columns. If these objects are nx.DiGraphs, make sure that graph.nodes()
have the same oder or pass a new nodelist to the class when initiating. The
same can be done for pd.DataFrames. In case <code>truth</code> and <code>est</code> are np.ndarray
objects it is the users responsibility to make sure that the objects are
indeed comparable.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/metrics.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DAGmetrics</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to calculate performance metrics for DAGs.</span>

<span class="sd">    Make sure that the ground truth and the estimated DAG have the same order of</span>
<span class="sd">    rows/columns. If these objects are nx.DiGraphs, make sure that graph.nodes()</span>
<span class="sd">    have the same oder or pass a new nodelist to the class when initiating. The</span>
<span class="sd">    same can be done for pd.DataFrames. In case `truth` and `est` are np.ndarray</span>
<span class="sd">    objects it is the users responsibility to make sure that the objects are</span>
<span class="sd">    indeed comparable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">truth</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">est</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">nodelist</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits the DAGmetrics class.</span>

<span class="sd">        Args:</span>
<span class="sd">            truth (nx.DiGraph | pd.DataFrame | np.ndarray): _description_</span>
<span class="sd">            est (nx.DiGraph | pd.DataFrame | np.ndarray): _description_</span>
<span class="sd">            nodelist (list, optional): _description_. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: _description_</span>
<span class="sd">            TypeError: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Ground truth graph has to be one of the permitted classes.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Estimated graph has to be one of the permitted classes&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">truth</span> <span class="o">=</span> <span class="n">DAGmetrics</span><span class="o">.</span><span class="n">_convert_to_numpy</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">est</span> <span class="o">=</span> <span class="n">DAGmetrics</span><span class="o">.</span><span class="n">_convert_to_numpy</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate Precision, Recall and F1 and g score.</span>

<span class="sd">        Return:</span>
<span class="sd">        precision: float</span>
<span class="sd">            TP/(TP + FP)</span>
<span class="sd">        recall: float</span>
<span class="sd">            TP/(TP + FN)</span>
<span class="sd">        f1: float</span>
<span class="sd">            2*(recall*precision)/(recall+precision)</span>
<span class="sd">        gscore: float</span>
<span class="sd">            max(0, (TP-FP))/(TP+FN)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">TWO</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">est</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">truth</span><span class="o">.</span><span class="n">shape</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">est</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">est</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">TP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">est</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">truth</span><span class="p">)</span> <span class="o">==</span> <span class="n">TWO</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">TP_FP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">est</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">FP</span> <span class="o">=</span> <span class="n">TP_FP</span> <span class="o">-</span> <span class="n">TP</span>
        <span class="n">TP_FN</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truth</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="n">precision</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">TP_FP</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">recall</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">TP_FN</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">recall</span> <span class="o">*</span> <span class="n">precision</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">((</span><span class="n">recall</span> <span class="o">+</span> <span class="n">precision</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gscore</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">TP</span> <span class="o">-</span> <span class="n">FP</span><span class="p">))</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">TP_FN</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span> <span class="s2">&quot;gscore&quot;</span><span class="p">:</span> <span class="n">gscore</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_shd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count_anticausal_twice</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate Structural Hamming Distance (SHD).</span>

<span class="sd">        Args:</span>
<span class="sd">            count_anticausal_twice (bool, optional): If edge is pointing in the wrong direction</span>
<span class="sd">                it&#39;s also missing in the right direction and is counted twice. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truth</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">est</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count_anticausal_twice</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">+</span> <span class="n">dist</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">dist</span><span class="p">[</span><span class="n">dist</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Collects all metrics defined in this class in a dict.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, float|int]: Metrics calculated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_scores</span><span class="p">()</span>
        <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;shd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">metrics</span>
        <span class="k">return</span> <span class="n">metrics</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_to_numpy</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">nodelist</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">nodelist</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">nodelist</span><span class="p">)[</span><span class="n">nodelist</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="causalAssembly.metrics.DAGmetrics.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">est</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Inits the DAGmetrics class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>truth</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>est</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nodelist</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">truth</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">est</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">nodelist</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits the DAGmetrics class.</span>

<span class="sd">    Args:</span>
<span class="sd">        truth (nx.DiGraph | pd.DataFrame | np.ndarray): _description_</span>
<span class="sd">        est (nx.DiGraph | pd.DataFrame | np.ndarray): _description_</span>
<span class="sd">        nodelist (list, optional): _description_. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: _description_</span>
<span class="sd">        TypeError: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Ground truth graph has to be one of the permitted classes.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Estimated graph has to be one of the permitted classes&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">truth</span> <span class="o">=</span> <span class="n">DAGmetrics</span><span class="o">.</span><span class="n">_convert_to_numpy</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">est</span> <span class="o">=</span> <span class="n">DAGmetrics</span><span class="o">.</span><span class="n">_convert_to_numpy</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.metrics.DAGmetrics.collect_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collect_metrics</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Collects all metrics defined in this class in a dict.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span> | <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, float|int]: Metrics calculated</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/metrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">collect_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collects all metrics defined in this class in a dict.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, float|int]: Metrics calculated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_scores</span><span class="p">()</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;shd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shd</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">metrics</span>
    <span class="k">return</span> <span class="n">metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.drf_fitting"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.drf_fitting.DRF" class="doc doc-heading">
            <code>DRF</code>


</h2>


    <div class="doc doc-contents ">


        <p>Wrapper around the corresponding R package.</p>
<p>Distributional Random Forests (Cevid et al., 2020).
Closely adopted from their python wrapper.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/drf_fitting.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DRF</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper around the corresponding R package.</span>

<span class="sd">    Distributional Random Forests (Cevid et al., 2020).</span>
<span class="sd">    Closely adopted from their python wrapper.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the DRF object with fit parameters.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">fit_params</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit DRF in order to estimate conditional distribution P(Y|X=x).</span>

<span class="sd">        Args:</span>
<span class="sd">            X (pd.DataFrame): Predictor variables.</span>
<span class="sd">            Y (pd.DataFrame | pd.Series): Response variable(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y_train</span> <span class="o">=</span> <span class="n">Y</span>

        <span class="c1"># Use localconverter</span>
        <span class="k">with</span> <span class="n">localconverter</span><span class="p">(</span><span class="n">R_CONVERTER</span><span class="p">):</span>
            <span class="n">X_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">Y_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r_fit_object</span> <span class="o">=</span> <span class="n">drf_r_package</span><span class="o">.</span><span class="n">drf</span><span class="p">(</span><span class="n">X_r</span><span class="p">,</span> <span class="n">Y_r</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">produce_sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">newdata</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample data from fitted drf.</span>

<span class="sd">        Args:</span>
<span class="sd">            newdata (pd.DataFrame): Data samples to predict from.</span>
<span class="sd">            random_state (np.random.Generator): control random state.</span>
<span class="sd">            n (int, optional): Number of n-samples to draw. Defaults to 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: New predicted sample of Y.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">localconverter</span><span class="p">(</span><span class="n">R_CONVERTER</span><span class="p">):</span>
            <span class="n">newdata_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">newdata</span><span class="p">)</span>
            <span class="n">r_output</span> <span class="o">=</span> <span class="n">drf_r_package</span><span class="o">.</span><span class="n">predict_drf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_fit_object</span><span class="p">,</span> <span class="n">newdata_r</span><span class="p">)</span>

            <span class="c1"># Convert back to Python</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">rpy2py</span><span class="p">(</span><span class="n">base_r_package</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(</span><span class="n">r_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">rpy2py</span><span class="p">(</span><span class="n">base_r_package</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(</span><span class="n">r_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">newdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">newdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ids</span><span class="p">,</span> <span class="p">:]</span>

        <span class="k">return</span> <span class="n">sample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="causalAssembly.drf_fitting.DRF.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the DRF object with fit parameters.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/drf_fitting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the DRF object with fit parameters.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">fit_params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.drf_fitting.DRF.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fit DRF in order to estimate conditional distribution P(Y|X=x).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predictor variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Y</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | <span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response variable(s).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/drf_fitting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit DRF in order to estimate conditional distribution P(Y|X=x).</span>

<span class="sd">    Args:</span>
<span class="sd">        X (pd.DataFrame): Predictor variables.</span>
<span class="sd">        Y (pd.DataFrame | pd.Series): Response variable(s).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Y_train</span> <span class="o">=</span> <span class="n">Y</span>

    <span class="c1"># Use localconverter</span>
    <span class="k">with</span> <span class="n">localconverter</span><span class="p">(</span><span class="n">R_CONVERTER</span><span class="p">):</span>
        <span class="n">X_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">Y_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_fit_object</span> <span class="o">=</span> <span class="n">drf_r_package</span><span class="o">.</span><span class="n">drf</span><span class="p">(</span><span class="n">X_r</span><span class="p">,</span> <span class="n">Y_r</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.drf_fitting.DRF.produce_sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">produce_sample</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span> <span class="n">random_state</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sample data from fitted drf.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>newdata</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data samples to predict from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="numpy.random.Generator">Generator</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>control random state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of n-samples to draw. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: New predicted sample of Y.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/drf_fitting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">produce_sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">newdata</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample data from fitted drf.</span>

<span class="sd">    Args:</span>
<span class="sd">        newdata (pd.DataFrame): Data samples to predict from.</span>
<span class="sd">        random_state (np.random.Generator): control random state.</span>
<span class="sd">        n (int, optional): Number of n-samples to draw. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: New predicted sample of Y.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">localconverter</span><span class="p">(</span><span class="n">R_CONVERTER</span><span class="p">):</span>
        <span class="n">newdata_r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">py2rpy</span><span class="p">(</span><span class="n">newdata</span><span class="p">)</span>
        <span class="n">r_output</span> <span class="o">=</span> <span class="n">drf_r_package</span><span class="o">.</span><span class="n">predict_drf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_fit_object</span><span class="p">,</span> <span class="n">newdata_r</span><span class="p">)</span>

        <span class="c1"># Convert back to Python</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">rpy2py</span><span class="p">(</span><span class="n">base_r_package</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(</span><span class="n">r_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">rpy2py</span><span class="p">(</span><span class="n">base_r_package</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(</span><span class="n">r_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">newdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">newdata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ids</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">sample</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="causalAssembly.drf_fitting.fit_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_drf</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fit distributional random forests to the factorization implied by the current graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ProductionLineGraph (causalAssembly.models_dag.ProductionLineGraph)" href="#causalAssembly.models_dag.ProductionLineGraph">ProductionLineGraph</a> | <a class="autorefs autorefs-internal" title="ProcessCell (causalAssembly.models_dag.ProcessCell)" href="#causalAssembly.models_dag.ProcessCell">ProcessCell</a> | <a class="autorefs autorefs-internal" title="DAG (causalAssembly.dag.DAG)" href="#causalAssembly.dag.DAG">DAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graph to fit the DRF to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns of dataframe need to match name and order of the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises: ValueError: Raises error if columns don't meet this requirement</p>
<p>Returns: (dict): dict of fitted DRFs.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/drf_fitting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit_drf</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">ProductionLineGraph</span> <span class="o">|</span> <span class="n">ProcessCell</span> <span class="o">|</span> <span class="n">DAG</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit distributional random forests to the factorization implied by the current graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph (ProductionLineGraph | ProcessCell | DAG): Graph to fit the DRF to.</span>
<span class="sd">        data (pd.DataFrame): Columns of dataframe need to match name and order of the graph</span>

<span class="sd">    Raises: ValueError: Raises error if columns don&#39;t meet this requirement</span>

<span class="sd">    Returns: (dict): dict of fitted DRFs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tempdata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">tempdata</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">tempdata</span> <span class="o">=</span> <span class="n">tempdata</span><span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data columns don&#39;t match node names.&quot;</span><span class="p">)</span>

    <span class="n">drf_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parents</span><span class="p">:</span>
            <span class="n">drf_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">tempdata</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">parents</span><span class="p">:</span>
            <span class="c1"># default setting as suggested in the paper</span>
            <span class="n">drf_object</span> <span class="o">=</span> <span class="n">DRF</span><span class="p">(</span><span class="n">min_node_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">num_trees</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">splitting_rule</span><span class="o">=</span><span class="s2">&quot;FourierMMD&quot;</span><span class="p">)</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">tempdata</span><span class="p">[</span><span class="n">parents</span><span class="p">]</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">tempdata</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
            <span class="n">drf_object</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
            <span class="n">drf_dict</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">drf_object</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected behavior in DRF. Check whether data and DAG match?&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">drf_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.pdag"></a>
    <div class="doc doc-contents first">

        <p>Utility classes and functions related to causalAssembly.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.pdag.PDAG" class="doc doc-heading">
            <code>PDAG</code>


</h2>


    <div class="doc doc-contents ">


        <p>Class for dealing with partially directed graphs.</p>
<p>i.e., graphs that contain both directed and undirected edges.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for dealing with partially directed graphs.</span>

<span class="sd">    i.e., graphs that contain both directed and undirected edges.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dir_edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">undir_edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits the PDAG class.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes (list | None, optional): _description_. Defaults to None.</span>
<span class="sd">            dir_edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">            undir_edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">dir_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">undir_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">undir_edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">dir_edge</span> <span class="ow">in</span> <span class="n">dir_edges</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_dir_edge</span><span class="p">(</span><span class="o">*</span><span class="n">dir_edge</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unir_edge</span> <span class="ow">in</span> <span class="n">undir_edges</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_undir_edge</span><span class="p">(</span><span class="o">*</span><span class="n">unir_edge</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_dir_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_undir_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all children of node `node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (str): node in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of children.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all parents of node `node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (str): node in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of parents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all neighbors of node `node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (str): node in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of neighbors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">undir_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all undirected neighbors of node `node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            node (str): node in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of undirected neighbors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the graph contains an directed or undirected edge between i and j.</span>

<span class="sd">        Args:</span>
<span class="sd">            i (str): node i.</span>
<span class="sd">            j (str): node j.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if i-j or i-&gt;j or i&lt;-j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">,</span>
                <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_clique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potential_clique</span><span class="p">:</span> <span class="nb">set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check every pair of node X potential_clique is adjacent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas_adjacency</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd_amat</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build PDAG from a Pandas adjacency matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            pd_amat (pd.DataFrame): input adjacency matrix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PDAG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">all_connections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd_amat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
            <span class="n">all_connections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">start</span><span class="p">[</span><span class="n">idx</span><span class="p">]],</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">end</span><span class="p">[</span><span class="n">idx</span><span class="p">]]))</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_connections</span><span class="p">]</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">arc</span> <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">arc</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">undir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">)]</span>

        <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">PDAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">dir_edges</span><span class="o">=</span><span class="n">dir_edges</span><span class="p">,</span> <span class="n">undir_edges</span><span class="o">=</span><span class="n">undir_edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes edge in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            i (str): tail</span>
<span class="sd">            j (str): head</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: if edge does not exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge does not exist in current PDAG&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">undir_to_dir_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Takes a undirected edge and turns it into a directed one.</span>

<span class="sd">        tail indicates the starting node of the edge and head the end node, i.e.</span>
<span class="sd">        tail -&gt; head.</span>

<span class="sd">        Args:</span>
<span class="sd">            tail (str): starting node</span>
<span class="sd">            head (str): end node</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: if edge does not exist or is not undirected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">head</span><span class="p">,</span>
            <span class="n">tail</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge seems not to be undirected or even there at all.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">tail</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">tail</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_dir_edge</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a node from the graph.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">u_nbr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">u_nbr</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">u_nbr</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Algorithm as described in Chickering (2002).</span>

<span class="sd">            1. From PDAG P create DAG G containing all directed edges from P</span>
<span class="sd">            2. Repeat the following: Select node v in P s.t.</span>
<span class="sd">                i. v has no outgoing edges (children) i.e. \\(ch(v) = \\emptyset \\)</span>

<span class="sd">                ii. \\(neigh(v) \\neq \\emptyset\\)</span>
<span class="sd">                    Then \\( (pa(v) \\cup (neigh(v) \\) form a clique.</span>
<span class="sd">                    For each v that is in a clique and is part of an undirected edge in P</span>
<span class="sd">                    i.e. w - v, insert a directed edge w -&gt; v in G.</span>
<span class="sd">                    Remove v and all incident edges from P and continue with next node.</span>
<span class="sd">                    Until all nodes have been deleted from P.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.DiGraph: DAG that belongs to the MEC implied by the PDAG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pdag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">dag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">pdag</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">pdag</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pdag</span><span class="o">.</span><span class="n">num_undir_edges</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">pdag</span><span class="o">.</span><span class="n">nnodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># find node with (1) no directed outgoing edges and</span>
                <span class="c1">#                (2) the set of undirected neighbors is either empty or</span>
                <span class="c1">#                    undirected neighbors + parents of X are a clique</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">pdag</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                    <span class="n">children</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">neighbors</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="c1"># pdag._undirected_neighbors[node]</span>
                    <span class="n">parents</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">potential_clique_members</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>

                    <span class="n">is_clique</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">is_clique</span><span class="p">(</span><span class="n">potential_clique_members</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">children</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">neighbors</span> <span class="ow">or</span> <span class="n">is_clique</span><span class="p">):</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="c1"># add all edges of node as outgoing edges to dag</span>
                        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span>
                                <span class="n">incident_node</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">node</span><span class="p">}</span>
                                <span class="n">dag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">incident_node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

                        <span class="n">pdag</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                        <span class="k">break</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PDAG not extendible: Random DAG on skeleton drawn.&quot;</span><span class="p">)</span>

                    <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_amat_to_dag</span><span class="p">(),</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>

                    <span class="k">break</span>

            <span class="k">return</span> <span class="n">dag</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns adjacency matrix.</span>

<span class="sd">        The i,jth</span>
<span class="sd">        entry being one indicates that there is an edge</span>
<span class="sd">        from i to j. A zero indicates that there is no edge.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: adjacency matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">amat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnodes</span><span class="p">]),</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">:</span>
            <span class="n">amat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
            <span class="n">amat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">amat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">amat</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_amat_to_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjacency matrix to random DAG.</span>

<span class="sd">        Transform the adjacency matrix of an PDAG to the adjacency</span>
<span class="sd">        matrix of a SOME DAG in the Markov equivalence class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: DAG, a member of the MEC.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pdag_amat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">pdag_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">## amat to skel</span>
        <span class="n">skel</span> <span class="o">=</span> <span class="n">pdag_amat</span> <span class="o">+</span> <span class="n">pdag_amat</span><span class="o">.</span><span class="n">T</span>
        <span class="n">skel</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">skel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">## permute skel</span>
        <span class="n">permute_ord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">skel</span> <span class="o">=</span> <span class="n">skel</span><span class="p">[:,</span> <span class="n">permute_ord</span><span class="p">][</span><span class="n">permute_ord</span><span class="p">]</span>

        <span class="c1">## skel to dag</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">skel</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">skel</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">## inverse permutation</span>
        <span class="n">i_ord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">permute_ord</span><span class="p">)</span>
        <span class="n">skel</span> <span class="o">=</span> <span class="n">skel</span><span class="p">[:,</span> <span class="n">i_ord</span><span class="p">][</span><span class="n">i_ord</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">skel</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vstructs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve v-structures.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of all v-structures</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vstructures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">p1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p1</span><span class="p">]:</span>
                    <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
                    <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p2</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">vstructures</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a copy of the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PDAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">,</span> <span class="n">dir_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="p">,</span> <span class="n">undir_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot PDAG.&quot;&quot;&quot;</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to networkx graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.MultiDiGraph: Graph with directed and undirected edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx_pdag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">()</span>
        <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
            <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
            <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">nx_pdag</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_meek_mec_enumeration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdag</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">,</span> <span class="n">dag_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursion algorithm which recursively applies the following steps.</span>

<span class="sd">            1. Orient the first undirected edge found.</span>
<span class="sd">            2. Apply Meek rules.</span>
<span class="sd">            3. Recurse with each direction of the oriented edge.</span>
<span class="sd">        This corresponds to Algorithm 2 in Wienbst et al. (2023).</span>

<span class="sd">        Args:</span>
<span class="sd">            pdag (PDAG): partially directed graph in question.</span>
<span class="sd">            dag_list (list): list of currently found DAGs.</span>

<span class="sd">        References:</span>
<span class="sd">            Wienbst, Marcel, et al. &quot;Efficient enumeration of Markov equivalent DAGs.&quot;</span>
<span class="sd">            Proceedings of the AAAI Conference on Artificial Intelligence.</span>
<span class="sd">            Vol. 37. No. 10. 2023.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">g_copy</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">g_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_meek_rules</span><span class="p">(</span><span class="n">g_copy</span><span class="p">)</span>  <span class="c1"># Apply Meek rules</span>

        <span class="n">undir_edges</span> <span class="o">=</span> <span class="n">g_copy</span><span class="o">.</span><span class="n">undir_edges</span>
        <span class="k">if</span> <span class="n">undir_edges</span><span class="p">:</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">undir_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Take first undirected edge</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g_copy</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
            <span class="c1"># makes sure that flaoting nodes are preserved</span>
            <span class="n">new_member</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
            <span class="n">new_member</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">g_copy</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
            <span class="n">new_member</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">g_copy</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">)</span>
            <span class="n">dag_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_member</span><span class="p">)</span>
            <span class="k">return</span>  <span class="c1"># Add DAG to current list</span>

        <span class="c1"># Recursion first orientation:</span>
        <span class="n">g_copy</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meek_mec_enumeration</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">g_copy</span><span class="p">,</span> <span class="n">dag_list</span><span class="o">=</span><span class="n">dag_list</span><span class="p">)</span>
        <span class="n">g_copy</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

        <span class="c1"># Recursion second orientation</span>
        <span class="n">g_copy</span><span class="o">.</span><span class="n">_add_dir_edge</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meek_mec_enumeration</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">g_copy</span><span class="p">,</span> <span class="n">dag_list</span><span class="o">=</span><span class="n">dag_list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_allDAGs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recursion algorithm which recursively applies the following steps.</span>

<span class="sd">            1. Orient the first undirected edge found.</span>
<span class="sd">            2. Apply Meek rules.</span>
<span class="sd">            3. Recurse with each direction of the oriented edge.</span>
<span class="sd">        This corresponds to Algorithm 2 in Wienbst et al. (2023).</span>

<span class="sd">        References:</span>
<span class="sd">            Wienbst, Marcel, et al. &quot;Efficient enumeration of Markov equivalent DAGs.&quot;</span>
<span class="sd">            Proceedings of the AAAI Conference on Artificial Intelligence.</span>
<span class="sd">            Vol. 37. No. 10. 2023.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_dags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meek_mec_enumeration</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dag_list</span><span class="o">=</span><span class="n">all_dags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_dags</span>

    <span class="c1"># use Meek&#39;s cpdag2alldag</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_meek_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">G</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply all four Meek rules to a PDAG turning it into a CPDAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            G (PDAG): PDAG to complete</span>

<span class="sd">        Returns:</span>
<span class="sd">            PDAG: completed PDAG.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Apply Meek Rules</span>
        <span class="n">cpdag</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_1</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
        <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_2</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
        <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_3</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
        <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_4</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cpdag</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_random_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provides a random DAG residing in the MEC.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.DiGraph: random DAG living in MEC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_dag_candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">num_undir_edges</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">chosen_edge</span> <span class="o">=</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">num_undir_edges</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">choose_orientation</span> <span class="o">=</span> <span class="p">[</span><span class="n">chosen_edge</span><span class="p">,</span> <span class="n">chosen_edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">node_i</span><span class="p">,</span> <span class="n">node_j</span> <span class="o">=</span> <span class="n">choose_orientation</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">choose_orientation</span><span class="p">))]</span>

            <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">node_i</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">node_j</span><span class="p">)</span>
            <span class="n">to_dag_candidate</span> <span class="o">=</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">_apply_meek_rules</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="n">to_dag_candidate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all nods in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nnodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of nodes in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_undir_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of undirected edges in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of undirected edges</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_dir_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of directed edges in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of directed edges</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_adjacencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of adjacent nodes in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of adjacent nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_undir_edges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dir_edges</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">undir_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all undirected edges in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]: List of undirected edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dir_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all directed edges in current PDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]: List of directed edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.adjacency_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">adjacency_matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns adjacency matrix.</p>
<p>The i,jth
entry being one indicates that there is an edge
from i to j. A zero indicates that there is no edge.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: adjacency matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.dir_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dir_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all directed edges in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]: List of directed edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.nnodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nnodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of nodes in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all nods in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.num_adjacencies" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_adjacencies</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of adjacent nodes in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of adjacent nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.num_dir_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_dir_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of directed edges in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of directed edges</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.num_undir_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_undir_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of undirected edges in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of undirected edges</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.pdag.PDAG.undir_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">undir_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all undirected edges in current PDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]: List of undirected edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dir_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">undir_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Inits the PDAG class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir_edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>undir_edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dir_edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">undir_edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits the PDAG class.</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes (list | None, optional): _description_. Defaults to None.</span>
<span class="sd">        dir_edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">        undir_edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">dir_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">undir_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">undir_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dir_edge</span> <span class="ow">in</span> <span class="n">dir_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_dir_edge</span><span class="p">(</span><span class="o">*</span><span class="n">dir_edge</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">unir_edge</span> <span class="ow">in</span> <span class="n">undir_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_undir_edge</span><span class="p">(</span><span class="o">*</span><span class="n">unir_edge</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.children" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">children</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all children of node <code>node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current PDAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of children.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all children of node `node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (str): node in current PDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of children.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a copy of the graph.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a copy of the graph.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PDAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">,</span> <span class="n">dir_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="p">,</span> <span class="n">undir_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.from_pandas_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">pd_amat</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Build PDAG from a Pandas adjacency matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pd_amat</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input adjacency matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pandas_adjacency</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd_amat</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build PDAG from a Pandas adjacency matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        pd_amat (pd.DataFrame): input adjacency matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">all_connections</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd_amat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
        <span class="n">all_connections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">start</span><span class="p">[</span><span class="n">idx</span><span class="p">]],</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">end</span><span class="p">[</span><span class="n">idx</span><span class="p">]]))</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_connections</span><span class="p">]</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">arc</span> <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">arc</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">undir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">)]</span>

    <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">PDAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">dir_edges</span><span class="o">=</span><span class="n">dir_edges</span><span class="p">,</span> <span class="n">undir_edges</span><span class="o">=</span><span class="n">undir_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.is_adjacent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the graph contains an directed or undirected edge between i and j.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node i.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node j.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if i-j or i-&gt;j or i&lt;-j</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the graph contains an directed or undirected edge between i and j.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (str): node i.</span>
<span class="sd">        j (str): node j.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if i-j or i-&gt;j or i&lt;-j</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">,</span>
            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.is_clique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_clique</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check every pair of node X potential_clique is adjacent.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_clique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potential_clique</span><span class="p">:</span> <span class="nb">set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check every pair of node X potential_clique is adjacent.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.neighbors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all neighbors of node <code>node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current PDAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of neighbors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all neighbors of node `node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (str): node in current PDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of neighbors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.parents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all parents of node <code>node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current PDAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of parents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all parents of node `node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (str): node in current PDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of parents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.remove_edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes edge in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tail</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>head</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if edge does not exist</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes edge in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (str): tail</span>
<span class="sd">        j (str): head</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: if edge does not exist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge does not exist in current PDAG&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.remove_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove a node from the graph.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a node from the graph.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">u_nbr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">u_nbr</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">u_nbr</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot PDAG.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot PDAG.&quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.to_allDAGs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_allDAGs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Recursion algorithm which recursively applies the following steps.</p>
<pre><code>1. Orient the first undirected edge found.
2. Apply Meek rules.
3. Recurse with each direction of the oriented edge.
</code></pre>
<p>This corresponds to Algorithm 2 in Wienbst et al. (2023).</p>


<details class="references" open>
  <summary>References</summary>
  <p>Wienbst, Marcel, et al. "Efficient enumeration of Markov equivalent DAGs."
Proceedings of the AAAI Conference on Artificial Intelligence.
Vol. 37. No. 10. 2023.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_allDAGs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursion algorithm which recursively applies the following steps.</span>

<span class="sd">        1. Orient the first undirected edge found.</span>
<span class="sd">        2. Apply Meek rules.</span>
<span class="sd">        3. Recurse with each direction of the oriented edge.</span>
<span class="sd">    This corresponds to Algorithm 2 in Wienbst et al. (2023).</span>

<span class="sd">    References:</span>
<span class="sd">        Wienbst, Marcel, et al. &quot;Efficient enumeration of Markov equivalent DAGs.&quot;</span>
<span class="sd">        Proceedings of the AAAI Conference on Artificial Intelligence.</span>
<span class="sd">        Vol. 37. No. 10. 2023.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_dags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meek_mec_enumeration</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dag_list</span><span class="o">=</span><span class="n">all_dags</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_dags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.to_dag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dag</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Algorithm as described in Chickering (2002).</p>
<pre><code>1. From PDAG P create DAG G containing all directed edges from P
2. Repeat the following: Select node v in P s.t.
    i. v has no outgoing edges (children) i.e. \\(ch(v) = \\emptyset \\)

    ii. \\(neigh(v) \\neq \\emptyset\\)
        Then \\( (pa(v) \\cup (neigh(v) \\) form a clique.
        For each v that is in a clique and is part of an undirected edge in P
        i.e. w - v, insert a directed edge w -&gt; v in G.
        Remove v and all incident edges from P and continue with next node.
        Until all nodes have been deleted from P.
</code></pre>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.DiGraph: DAG that belongs to the MEC implied by the PDAG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Algorithm as described in Chickering (2002).</span>

<span class="sd">        1. From PDAG P create DAG G containing all directed edges from P</span>
<span class="sd">        2. Repeat the following: Select node v in P s.t.</span>
<span class="sd">            i. v has no outgoing edges (children) i.e. \\(ch(v) = \\emptyset \\)</span>

<span class="sd">            ii. \\(neigh(v) \\neq \\emptyset\\)</span>
<span class="sd">                Then \\( (pa(v) \\cup (neigh(v) \\) form a clique.</span>
<span class="sd">                For each v that is in a clique and is part of an undirected edge in P</span>
<span class="sd">                i.e. w - v, insert a directed edge w -&gt; v in G.</span>
<span class="sd">                Remove v and all incident edges from P and continue with next node.</span>
<span class="sd">                Until all nodes have been deleted from P.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.DiGraph: DAG that belongs to the MEC implied by the PDAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pdag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">dag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">pdag</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">pdag</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pdag</span><span class="o">.</span><span class="n">num_undir_edges</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dag</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">pdag</span><span class="o">.</span><span class="n">nnodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># find node with (1) no directed outgoing edges and</span>
            <span class="c1">#                (2) the set of undirected neighbors is either empty or</span>
            <span class="c1">#                    undirected neighbors + parents of X are a clique</span>
            <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">pdag</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="n">children</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">neighbors</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="c1"># pdag._undirected_neighbors[node]</span>
                <span class="n">parents</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">potential_clique_members</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>

                <span class="n">is_clique</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">is_clique</span><span class="p">(</span><span class="n">potential_clique_members</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">children</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">neighbors</span> <span class="ow">or</span> <span class="n">is_clique</span><span class="p">):</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="c1"># add all edges of node as outgoing edges to dag</span>
                    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span>
                            <span class="n">incident_node</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">node</span><span class="p">}</span>
                            <span class="n">dag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">incident_node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

                    <span class="n">pdag</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;PDAG not extendible: Random DAG on skeleton drawn.&quot;</span><span class="p">)</span>

                <span class="n">dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_amat_to_dag</span><span class="p">(),</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>

                <span class="k">break</span>

        <span class="k">return</span> <span class="n">dag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.to_networkx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_networkx</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert to networkx graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.MultiDiGraph">MultiDiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.MultiDiGraph: Graph with directed and undirected edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to networkx graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.MultiDiGraph: Graph with directed and undirected edges.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx_pdag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">()</span>
    <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_edges</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
        <span class="n">nx_pdag</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">nx_pdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.to_random_dag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_random_dag</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Provides a random DAG residing in the MEC.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.DiGraph: random DAG living in MEC</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_random_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides a random DAG residing in the MEC.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.DiGraph: random DAG living in MEC</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_dag_candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">num_undir_edges</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">chosen_edge</span> <span class="o">=</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">num_undir_edges</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">choose_orientation</span> <span class="o">=</span> <span class="p">[</span><span class="n">chosen_edge</span><span class="p">,</span> <span class="n">chosen_edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">node_i</span><span class="p">,</span> <span class="n">node_j</span> <span class="o">=</span> <span class="n">choose_orientation</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">choose_orientation</span><span class="p">))]</span>

        <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">node_i</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">node_j</span><span class="p">)</span>
        <span class="n">to_dag_candidate</span> <span class="o">=</span> <span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">_apply_meek_rules</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="n">to_dag_candidate</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">to_dag_candidate</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.undir_neighbors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">undir_neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all undirected neighbors of node <code>node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current PDAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of undirected neighbors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">undir_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all undirected neighbors of node `node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        node (str): node in current PDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of undirected neighbors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.undir_to_dir_edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Takes a undirected edge and turns it into a directed one.</p>
<p>tail indicates the starting node of the edge and head the end node, i.e.
tail -&gt; head.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tail</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>starting node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>head</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>end node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if edge does not exist or is not undirected.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">undir_to_dir_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tail</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes a undirected edge and turns it into a directed one.</span>

<span class="sd">    tail indicates the starting node of the edge and head the end node, i.e.</span>
<span class="sd">    tail -&gt; head.</span>

<span class="sd">    Args:</span>
<span class="sd">        tail (str): starting node</span>
<span class="sd">        head (str): end node</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: if edge does not exist or is not undirected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">head</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">,</span>
    <span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge seems not to be undirected or even there at all.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undir_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">tail</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_neighbors</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">tail</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_undirected_neighbors</span><span class="p">[</span><span class="n">head</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_dir_edge</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.pdag.PDAG.vstructs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vstructs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve v-structures.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of all v-structures</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vstructs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve v-structures.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of all v-structures</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vstructures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p1</span><span class="p">]:</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p2</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">vstructures</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.dag2cpdag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convertes a DAG into its unique CPDAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG the CPDAG corresponds to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>unique CPDAG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convertes a DAG into its unique CPDAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        dag (nx.DiGraph): DAG the CPDAG corresponds to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: unique CPDAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copy_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
    <span class="c1"># Skeleton</span>
    <span class="n">skeleton</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">copy_dag</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">())</span>
    <span class="c1"># v-Structures</span>
    <span class="n">vstructures</span> <span class="o">=</span> <span class="n">vstructs</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="n">copy_dag</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">vstructures</span><span class="p">:</span>  <span class="c1"># orient v-structures</span>
        <span class="n">skeleton</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">pdag_init</span> <span class="o">=</span> <span class="n">PDAG</span><span class="o">.</span><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">skeleton</span><span class="p">)</span>

    <span class="c1"># Apply Meek Rules</span>
    <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_1</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">pdag_init</span><span class="p">)</span>
    <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_2</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
    <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_3</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>
    <span class="n">cpdag</span> <span class="o">=</span> <span class="n">rule_4</span><span class="p">(</span><span class="n">pdag</span><span class="o">=</span><span class="n">cpdag</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cpdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.rule_1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule_1</span><span class="p">(</span><span class="n">pdag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Meeks first rule.</p>
<p>Given the following pattern X -&gt; Y - Z. Orient Y - Z to Y -&gt; Z
if X and Z are non-adjacent (otherwise a new v-structure arises).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pdag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG before application of rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG after application of rule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule_1</span><span class="p">(</span><span class="n">pdag</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meeks first rule.</span>

<span class="sd">    Given the following pattern X -&gt; Y - Z. Orient Y - Z to Y -&gt; Z</span>
<span class="sd">    if X and Z are non-adjacent (otherwise a new v-structure arises).</span>

<span class="sd">    Args:</span>
<span class="sd">        pdag (PDAG): PDAG before application of rule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: PDAG after application of rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copy_pdag</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="n">reverse_edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">test_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="n">reverse_edge</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">test_edges</span><span class="p">:</span>
            <span class="n">orient</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">undir_parents</span> <span class="o">=</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">undir_parents</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">undir_parents</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">head</span><span class="p">):</span>
                        <span class="n">orient</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">orient</span><span class="p">:</span>
                <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">copy_pdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.rule_2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule_2</span><span class="p">(</span><span class="n">pdag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Meeks 2nd rule.</p>
<p>Given the following directed triple
X -&gt; Y -&gt; Z where X - Z are indeed adjacent.
Orient X - Z to X -&gt; Z otherwise a cycle arises.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pdag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG before application of rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG after application of rule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule_2</span><span class="p">(</span><span class="n">pdag</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meeks 2nd rule.</span>

<span class="sd">    Given the following directed triple</span>
<span class="sd">    X -&gt; Y -&gt; Z where X - Z are indeed adjacent.</span>
<span class="sd">    Orient X - Z to X -&gt; Z otherwise a cycle arises.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdag (PDAG): PDAG before application of rule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: PDAG after application of rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copy_pdag</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="n">reverse_edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">test_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="n">reverse_edge</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">test_edges</span><span class="p">:</span>
            <span class="n">orient</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">undir_children</span> <span class="o">=</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">undir_children</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">undir_children</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">child</span><span class="p">):</span>
                        <span class="n">orient</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">orient</span><span class="p">:</span>
                <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">copy_pdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.rule_3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule_3</span><span class="p">(</span><span class="n">pdag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Meeks third rule.</p>
<p>Orient X - Z to X -&gt; Z, whenever there are two triples
X - Y1 -&gt; Z and X - Y2 -&gt; Z such that Y1 and Y2 are non-adjacent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pdag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG before application of rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG after application of rule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule_3</span><span class="p">(</span><span class="n">pdag</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meeks third rule.</span>

<span class="sd">    Orient X - Z to X -&gt; Z, whenever there are two triples</span>
<span class="sd">    X - Y1 -&gt; Z and X - Y2 -&gt; Z such that Y1 and Y2 are non-adjacent.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdag (PDAG): PDAG before application of rule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: PDAG after application of rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TWO</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">copy_pdag</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="n">reverse_edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">test_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="n">reverse_edge</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">test_edges</span><span class="p">:</span>
            <span class="c1"># if true that tail - node1 -&gt; head and tail - node2 -&gt; head</span>
            <span class="c1"># while {node1 U node2} = 0 then orient tail -&gt; head</span>
            <span class="n">orient</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_neighbors</span><span class="p">(</span><span class="n">tail</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">TWO</span><span class="p">:</span>
                <span class="n">undir_n</span> <span class="o">=</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_neighbors</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">undir_n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="n">selection</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">node1</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">copy_pdag</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">node2</span><span class="p">)):</span>
                            <span class="n">orient</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">orient</span><span class="p">:</span>
                <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">pdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.rule_4" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rule_4</span><span class="p">(</span><span class="n">pdag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Meeks 4th rule.</p>
<p>Orient X - Y1 to X -&gt; Y1, whenever there are
two triples with X - Z and X - Y1 &lt;- Z and X - Y2 -&gt; Z
such that Y1 and Y2 are non-adjacent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pdag</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG before application of rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PDAG after application of rule.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rule_4</span><span class="p">(</span><span class="n">pdag</span><span class="p">:</span> <span class="n">PDAG</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meeks 4th rule.</span>

<span class="sd">    Orient X - Y1 to X -&gt; Y1, whenever there are</span>
<span class="sd">    two triples with X - Z and X - Y1 &lt;- Z and X - Y2 -&gt; Z</span>
<span class="sd">    such that Y1 and Y2 are non-adjacent.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdag (PDAG): PDAG before application of rule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: PDAG after application of rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">copy_pdag</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_edges</span><span class="p">:</span>
        <span class="n">reverse_edge</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">test_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="n">reverse_edge</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">test_edges</span><span class="p">:</span>
            <span class="n">orient</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_neighbors</span><span class="p">(</span><span class="n">tail</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">undirected_n</span> <span class="o">=</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_neighbors</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">undir_n</span> <span class="ow">in</span> <span class="n">undirected_n</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tail</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">undir_n</span><span class="p">):</span>
                        <span class="n">children_select</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">copy_pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">undir_n</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">children_select</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">children_select</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">copy_pdag</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
                                    <span class="n">orient</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">orient</span><span class="p">:</span>
                <span class="n">copy_pdag</span><span class="o">.</span><span class="n">undir_to_dir_edge</span><span class="p">(</span><span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">pdag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="causalAssembly.pdag.vstructs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vstructs</span><span class="p">(</span><span class="n">dag</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve all v-structures in a DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG in question</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set of all v-structures.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/pdag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vstructs</span><span class="p">(</span><span class="n">dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve all v-structures in a DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        dag (nx.DiGraph): DAG in question</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: Set of all v-structures.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vstructures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dag</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">)),</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># get all parents of node</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dag</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dag</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">):</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p2</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">vstructures</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="causalAssembly.dag"></a>
    <div class="doc doc-contents first">

        <p>DAG class.</p>
<p>Copyright (c) 2023 Robert Bosch GmbH</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="causalAssembly.dag.DAG" class="doc doc-heading">
            <code>DAG</code>


</h2>


    <div class="doc doc-contents ">


        <p>General class for dealing with directed acyclic graph i.e.</p>
<p>graphs that are directed and must not contain any cycles.</p>







              <details class="quote">
                <summary>Source code in <code>causalAssembly/dag.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;General class for dealing with directed acyclic graph i.e.</span>

<span class="sd">    graphs that are directed and must not contain any cycles.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes (list | None, optional): _description_. Defaults to None.</span>
<span class="sd">            edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

        <span class="c1"># Check if graph is acyclic</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_acyclic</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The edge set you provided </span><span class="se">\</span>
<span class="s2">                induces one or more cycles.</span><span class="se">\</span>
<span class="s2">                Check your input!&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Random state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span>

    <span class="nd">@random_state</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Specify numpy random number generator object!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span> <span class="o">=</span> <span class="n">r</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add edge to DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            edge (tuple[str, str]): Edge to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add multiple edges to DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            edges (list[tuple[str, str]]): Edges to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="o">=</span><span class="n">edge</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all children of node `of_node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            of_node (str): node in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: of children.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">of_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">of_node</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all parents of node `of_node`.</span>

<span class="sd">        Args:</span>
<span class="sd">            of_node (str): node in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: of parents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">of_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">of_node</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">induced_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the induced subgraph on the nodes in `nodes`.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes (list[str]): List of nodes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DAG: Induced subgraph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if the graph contains an directed edge between i and j.</span>

<span class="sd">        Args:</span>
<span class="sd">            i (str): node i.</span>
<span class="sd">            j (str): node j.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if i-&gt;j or i&lt;-j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_clique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potential_clique</span><span class="p">:</span> <span class="nb">set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check every pair of node X potential_clique is adjacent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_acyclic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the graph is acyclic.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if graph is acyclic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">nx_dag</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas_adjacency</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd_amat</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build DAG from a Pandas adjacency matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            pd_amat (pd.DataFrame): input adjacency matrix.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DAG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">all_connections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd_amat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
            <span class="n">all_connections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">start</span><span class="p">[</span><span class="n">idx</span><span class="p">]],</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">end</span><span class="p">[</span><span class="n">idx</span><span class="p">]]))</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_connections</span><span class="p">]</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">arc</span> <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">arc</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">dir_edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes edge in question.</span>

<span class="sd">        Args:</span>
<span class="sd">            i (str): tail</span>
<span class="sd">            j (str): head</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: if edge does not exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge does not exist in current DAG&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a node from the graph.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns adjacency matrix.</span>

<span class="sd">        The i,jth entry being one indicates that there is an edge</span>
<span class="sd">        from i to j. A zero indicates that there is no edge.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: adjacency matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">amat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">]),</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">amat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">amat</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vstructs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve v-structures.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: set of all v-structures</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vstructures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">p1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p1</span><span class="p">]:</span>
                    <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
                    <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p2</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">vstructures</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a copy of the graph.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot DAG.&quot;&quot;&quot;</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to networkx graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            nx.DiGraph: DAG.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx_dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">nx_dag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">nx_dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nx_dag</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all nods in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of nodes in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of directed edges in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Number of directed edges</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sparsity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sparsity of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: in [0,1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_edges</span> <span class="o">/</span> <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives all directed edges in current DAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple]: List of directed edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">causal_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the causal order of the current graph.</span>

<span class="sd">        Note that this order is in general not unique.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: Causal order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">lexicographical_topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_in_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum in-degree of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Maximum in-degree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">])</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_out_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum out-degree of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Maximum out-degree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">])</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_nx</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nx_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to DAG from nx.DiGraph.</span>

<span class="sd">        Args:</span>
<span class="sd">            nx_dag (nx.DiGraph): DAG in question.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If DAG is not nx.DiGraph</span>

<span class="sd">        Returns:</span>
<span class="sd">            DAG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nx_dag</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DAG must be of type nx.DiGraph&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">nx_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">),</span> <span class="n">edges</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">nx_dag</span><span class="o">.</span><span class="n">edges</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">            location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">                the current working directory. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">            smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">                be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion to CPDAG.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PDAG: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_drf</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads a drf dict from a .pkl file into the workspace.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): name of the file e.g. examplefile.pkl</span>
<span class="sd">            location (str, optional): path to file in case it&#39;s not located</span>
<span class="sd">                in the current working directory. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DRF (dict): dict of trained drf objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">drf</span><span class="p">:</span>
            <span class="n">pickle_drf</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">drf</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pickle_drf</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.adjacency_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">adjacency_matrix</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns adjacency matrix.</p>
<p>The i,jth entry being one indicates that there is an edge
from i to j. A zero indicates that there is no edge.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: adjacency matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.causal_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">causal_order</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the causal order of the current graph.</p>
<p>Note that this order is in general not unique.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: Causal order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all directed edges in current DAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple]: List of directed edges.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.max_in_degree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_in_degree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Maximum in-degree of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum in-degree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.max_out_degree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_out_degree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Maximum out-degree of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum out-degree</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get all nods in current DAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.num_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of directed edges in current DAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of directed edges</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.num_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of nodes in current DAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.random_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_state</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Random state.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="causalAssembly.dag.DAG.sparsity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sparsity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Sparsity of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>in [0,1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes (list | None, optional): _description_. Defaults to None.</span>
<span class="sd">        edges (list[tuple] | None, optional): _description_. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_random_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.add_edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add edge to DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>edge</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Edge to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add edge to DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (tuple[str, str]): Edge to add</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.add_edges_from" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add multiple edges to DAG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Edges to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add multiple edges to DAG.</span>

<span class="sd">    Args:</span>
<span class="sd">        edges (list[tuple[str, str]]): Edges to add</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="o">=</span><span class="n">edge</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.children" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">children</span><span class="p">(</span><span class="n">of_node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all children of node <code>of_node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>of_node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current DAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of children.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all children of node `of_node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        of_node (str): node in current DAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: of children.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">of_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">of_node</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a copy of the graph.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a copy of the graph.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.from_nx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_nx</span><span class="p">(</span><span class="n">nx_dag</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Convert to DAG from nx.DiGraph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nx_dag</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG in question.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If DAG is not nx.DiGraph</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DAG (causalAssembly.dag.DAG)" href="#causalAssembly.dag.DAG">DAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_nx</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">nx_dag</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to DAG from nx.DiGraph.</span>

<span class="sd">    Args:</span>
<span class="sd">        nx_dag (nx.DiGraph): DAG in question.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If DAG is not nx.DiGraph</span>

<span class="sd">    Returns:</span>
<span class="sd">        DAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nx_dag</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DAG must be of type nx.DiGraph&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">nx_dag</span><span class="o">.</span><span class="n">nodes</span><span class="p">),</span> <span class="n">edges</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">nx_dag</span><span class="o">.</span><span class="n">edges</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.from_pandas_adjacency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pandas_adjacency</span><span class="p">(</span><span class="n">pd_amat</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Build DAG from a Pandas adjacency matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pd_amat</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input adjacency matrix.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DAG (causalAssembly.dag.DAG)" href="#causalAssembly.dag.DAG">DAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DAG</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pandas_adjacency</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pd_amat</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build DAG from a Pandas adjacency matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        pd_amat (pd.DataFrame): input adjacency matrix.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DAG</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">all_connections</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd_amat</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
        <span class="n">all_connections</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">start</span><span class="p">[</span><span class="n">idx</span><span class="p">]],</span> <span class="n">pd_amat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">end</span><span class="p">[</span><span class="n">idx</span><span class="p">]]))</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_connections</span><span class="p">]</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">arc</span> <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">arc</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">dir_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">edge</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">all_connections</span> <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">dir_edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.induced_subgraph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">induced_subgraph</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the induced subgraph on the nodes in <code>nodes</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="DAG (causalAssembly.dag.DAG)" href="#causalAssembly.dag.DAG">DAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Induced subgraph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">induced_subgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the induced subgraph on the nodes in `nodes`.</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes (list[str]): List of nodes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DAG: Induced subgraph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">DAG</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.is_acyclic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_acyclic</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if the graph is acyclic.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if graph is acyclic.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_acyclic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the graph is acyclic.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if graph is acyclic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx_dag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">nx_dag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.is_adjacent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return True if the graph contains an directed edge between i and j.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node i.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node j.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if i-&gt;j or i&lt;-j</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if the graph contains an directed edge between i and j.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (str): node i.</span>
<span class="sd">        j (str): node j.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if i-&gt;j or i&lt;-j</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.is_clique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_clique</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check every pair of node X potential_clique is adjacent.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_clique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">potential_clique</span><span class="p">:</span> <span class="nb">set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check every pair of node X potential_clique is adjacent.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_adjacent</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">potential_clique</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.load_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_drf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Loads a drf dict from a .pkl file into the workspace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the file e.g. examplefile.pkl</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to file in case it's not located
in the current working directory. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DRF</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict of trained drf objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_drf</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a drf dict from a .pkl file into the workspace.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): name of the file e.g. examplefile.pkl</span>
<span class="sd">        location (str, optional): path to file in case it&#39;s not located</span>
<span class="sd">            in the current working directory. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DRF (dict): dict of trained drf objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">drf</span><span class="p">:</span>
        <span class="n">pickle_drf</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">drf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pickle_drf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.parents" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parents</span><span class="p">(</span><span class="n">of_node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gives all parents of node <code>of_node</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>of_node</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node in current DAG.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>of parents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">of_node</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gives all parents of node `of_node`.</span>

<span class="sd">    Args:</span>
<span class="sd">        of_node (str): node in current DAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: of parents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">of_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">of_node</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.remove_edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes edge in question.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>i</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tail</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>j</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>head</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if edge does not exist</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes edge in question.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (str): tail</span>
<span class="sd">        j (str): head</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: if edge does not exist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Edge does not exist in current DAG&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="o">.</span><span class="n">discard</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.remove_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove a node from the graph.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a node from the graph.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="p">{(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)}</span>

    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">child</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;I was never here&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.sample_from_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_from_drf</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Draw from the trained DRF.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to be drawn. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smoothed</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to true, marginal distributions will
be sampled from smoothed bootstraps. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_from_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw from the trained DRF.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int, optional): Number of samples to be drawn. Defaults to 10.</span>
<span class="sd">        smoothed (bool, optional): If set to true, marginal distributions will</span>
<span class="sd">            be sampled from smoothed bootstraps. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Data frame that follows the distribution implied by the ground truth.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_sample_from_drf</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">smoothed</span><span class="o">=</span><span class="n">smoothed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.save_drf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_drf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes a drf dict to file. Please provide the .pkl suffix!</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the file to be written e.g. examplefile.pkl</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to file in case it's not located in
the current working directory. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_drf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a drf dict to file. Please provide the .pkl suffix!</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): name of the file to be written e.g. examplefile.pkl</span>
<span class="sd">        location (str, optional): path to file in case it&#39;s not located in</span>
<span class="sd">            the current working directory. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="n">location_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">location_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">drf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot DAG.</p>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot DAG.&quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.to_cpdag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_cpdag</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Conversion to CPDAG.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PDAG</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="PDAG (causalAssembly.pdag.PDAG)" href="#causalAssembly.pdag.PDAG">PDAG</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_cpdag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PDAG</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Conversion to CPDAG.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDAG: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dag2cpdag</span><span class="p">(</span><span class="n">dag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.to_networkx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_networkx</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert to networkx graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.DiGraph: DAG.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to networkx graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.DiGraph: DAG.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx_dag</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">nx_dag</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
    <span class="n">nx_dag</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nx_dag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="causalAssembly.dag.DAG.vstructs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vstructs</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve v-structures.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>set</code></td>            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>set of all v-structures</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>causalAssembly/dag.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">vstructs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve v-structures.</span>

<span class="sd">    Returns:</span>
<span class="sd">        set: set of all v-structures</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vstructures</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parents</span><span class="p">[</span><span class="n">p1</span><span class="p">]:</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
                <span class="n">vstructures</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">p2</span><span class="p">,</span> <span class="n">node</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">vstructures</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>